"use strict";(self.webpackChunkchaos_mesh_website=self.webpackChunkchaos_mesh_website||[]).push([[7595],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>c});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),m=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},d=function(e){var t=m(e.components);return n.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),g=m(a),c=r,u=g["".concat(s,".").concat(c)]||g[c]||p[c]||i;return a?n.createElement(u,l(l({ref:t},d),{},{components:a})):n.createElement(u,l({ref:t},d))}));function c(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=g;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var m=2;m<i;m++)l[m]=a[m];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}g.displayName="MDXCreateElement"},72985:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>m});var n=a(87462),r=(a(67294),a(3905));const i={title:"Simulate JVM Application Faults"},l=void 0,o={unversionedId:"simulate-jvm-application-chaos-in-physical-nodes",id:"version-2.4.1/simulate-jvm-application-chaos-in-physical-nodes",title:"Simulate JVM Application Faults",description:"Chaosd simulates the faults of JVM application through Byteman. The supported fault types are as follows:",source:"@site/versioned_docs/version-2.4.1/simulate-jvm-application-chaos-in-physical-nodes.md",sourceDirName:".",slug:"/simulate-jvm-application-chaos-in-physical-nodes",permalink:"/docs/simulate-jvm-application-chaos-in-physical-nodes",draft:!1,editUrl:"https://github.com/chaos-mesh/website/edit/master/versioned_docs/version-2.4.1/simulate-jvm-application-chaos-in-physical-nodes.md",tags:[],version:"2.4.1",frontMatter:{title:"Simulate JVM Application Faults"},sidebar:"docs",previous:{title:"Simulate Disk Faults",permalink:"/docs/simulate-disk-pressure-in-physical-nodes"},next:{title:"Simulate Time Faults",permalink:"/docs/simulate-time-chaos-on-physical-nodes"}},s={},m=[{value:"Create experiments using the command-line mode",id:"create-experiments-using-the-command-line-mode",level:2},{value:"Throw custom exceptions using the command-line mode",id:"throw-custom-exceptions-using-the-command-line-mode",level:3},{value:"Commands for throwing custom exceptions",id:"commands-for-throwing-custom-exceptions",level:4},{value:"Configuration description for throwing custom exceptions",id:"configuration-description-for-throwing-custom-exceptions",level:4},{value:"Example for throwing custom exceptions",id:"example-for-throwing-custom-exceptions",level:4},{value:"Trigger garbage collection using the command-line mode",id:"trigger-garbage-collection-using-the-command-line-mode",level:3},{value:"Commands for triggering garbage collection",id:"commands-for-triggering-garbage-collection",level:4},{value:"Configuration description for triggering garbage collection",id:"configuration-description-for-triggering-garbage-collection",level:4},{value:"Example for triggering garbage collection",id:"example-for-triggering-garbage-collection",level:4},{value:"Increase method latency using the command-line mode",id:"increase-method-latency-using-the-command-line-mode",level:3},{value:"Commands for increasing method latency",id:"commands-for-increasing-method-latency",level:4},{value:"Configuration description for increasing method latency",id:"configuration-description-for-increasing-method-latency",level:4},{value:"Example for increasing method latency",id:"example-for-increasing-method-latency",level:4},{value:"Modify return values of a method using the command-line mode",id:"modify-return-values-of-a-method-using-the-command-line-mode",level:3},{value:"Commands for modifying return values of a method",id:"commands-for-modifying-return-values-of-a-method",level:4},{value:"Configuration description for modifying return values of a method",id:"configuration-description-for-modifying-return-values-of-a-method",level:4},{value:"Example for simulating the scenario of modifying return values of a method",id:"example-for-simulating-the-scenario-of-modifying-return-values-of-a-method",level:4},{value:"Trigger faults by setting Byteman configuration files using the command-line mode",id:"trigger-faults-by-setting-byteman-configuration-files-using-the-command-line-mode",level:3},{value:"Commands for triggering faults by setting Byteman configuration files",id:"commands-for-triggering-faults-by-setting-byteman-configuration-files",level:4},{value:"Configuration description for triggering faults by setting Byteman configuration files",id:"configuration-description-for-triggering-faults-by-setting-byteman-configuration-files",level:4},{value:"Example for triggering faults by setting Byteman configuration files",id:"example-for-triggering-faults-by-setting-byteman-configuration-files",level:4},{value:"Increase JVM stress using the command-line mode",id:"increase-jvm-stress-using-the-command-line-mode",level:3},{value:"Commands for increasing JVM stress",id:"commands-for-increasing-jvm-stress",level:4},{value:"Configuration description for increasing JVM stress",id:"configuration-description-for-increasing-jvm-stress",level:4},{value:"Example for increasing JVM stress",id:"example-for-increasing-jvm-stress",level:4},{value:"Create experiments using the service mode",id:"create-experiments-using-the-service-mode",level:2},{value:"Throw custom exceptions using the service mode",id:"throw-custom-exceptions-using-the-service-mode",level:3},{value:"Parameters for throwing custom exceptions",id:"parameters-for-throwing-custom-exceptions",level:4},{value:"Example for throwing custom exceptions using the service mode",id:"example-for-throwing-custom-exceptions-using-the-service-mode",level:4},{value:"Trigger garbage collection using service mode",id:"trigger-garbage-collection-using-service-mode",level:3},{value:"Parameters for triggering garbage collection",id:"parameters-for-triggering-garbage-collection",level:4},{value:"Example for triggering garbage collection using the service mode",id:"example-for-triggering-garbage-collection-using-the-service-mode",level:4},{value:"Increase method latency using service mode",id:"increase-method-latency-using-service-mode",level:3},{value:"Parameters for increasing method latency",id:"parameters-for-increasing-method-latency",level:4},{value:"Example for increasing method latency using the service mode",id:"example-for-increasing-method-latency-using-the-service-mode",level:4},{value:"Modify return values of a method using service mode",id:"modify-return-values-of-a-method-using-service-mode",level:3},{value:"Parameters for modifying return values of a method",id:"parameters-for-modifying-return-values-of-a-method",level:4},{value:"Example for modifying return values of a method using the service mode",id:"example-for-modifying-return-values-of-a-method-using-the-service-mode",level:4},{value:"Trigger faults by setting Byteman configuration files using service mode",id:"trigger-faults-by-setting-byteman-configuration-files-using-service-mode",level:3},{value:"Parameters for triggering faults by setting Byteman configuration files",id:"parameters-for-triggering-faults-by-setting-byteman-configuration-files",level:4},{value:"Example for triggering faults by setting Byteman configuration files using the service mode",id:"example-for-triggering-faults-by-setting-byteman-configuration-files-using-the-service-mode",level:4},{value:"Increase JVM stress using the service mode",id:"increase-jvm-stress-using-the-service-mode",level:3},{value:"Parameters for increasing JVM stress",id:"parameters-for-increasing-jvm-stress",level:4},{value:"Example for increasing JVM stress using the service mode",id:"example-for-increasing-jvm-stress-using-the-service-mode",level:4}],d={toc:m};function p(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Chaosd simulates the faults of JVM application through ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/chaos-mesh/byteman"},"Byteman"),". The supported fault types are as follows:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Throw custom exceptions"),(0,r.kt)("li",{parentName:"ul"},"Trigger garbage collection"),(0,r.kt)("li",{parentName:"ul"},"Increase method latency"),(0,r.kt)("li",{parentName:"ul"},"Modify return values of a method"),(0,r.kt)("li",{parentName:"ul"},"Trigger faults by setting Byteman configuration files"),(0,r.kt)("li",{parentName:"ul"},"Increase JVM pressure")),(0,r.kt)("p",null,"This document describes how to use Chaosd to create the above fault types of JVM experiments."),(0,r.kt)("h2",{id:"create-experiments-using-the-command-line-mode"},"Create experiments using the command-line mode"),(0,r.kt)("p",null,"This section introduces how to create the experiments of JVM application faults using the command-line mode."),(0,r.kt)("p",null,"Before creating the experiment, you can run the following command line to see the types of JVM application faults supported by Chaosd:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chaosd attack jvm -h\n")),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"JVM attack related commands\n\nUsage:\n  chaosd attack jvm [command]\n\nAvailable Commands:\n  exception   throw specified exception for specified method\n  gc          trigger GC for JVM\n  latency     inject latency to specified method\n  return      return specified value for specified method\n  rule-file   inject fault with configured byteman rule file\n  stress      inject stress to JVM\n\nFlags:\n  -h, --help       help for jvm\n      --pid int    the pid of Java process which needs to attach\n      --port int   the port of agent server (default 9288)\n\nGlobal Flags:\n      --log-level string   the log level of chaosd. The value can be 'debug', 'info', 'warn' and 'error'\n      --uid string         the experiment ID\n\nUse \"chaosd attack jvm [command] --help\" for more information about a command.\n")),(0,r.kt)("h3",{id:"throw-custom-exceptions-using-the-command-line-mode"},"Throw custom exceptions using the command-line mode"),(0,r.kt)("h4",{id:"commands-for-throwing-custom-exceptions"},"Commands for throwing custom exceptions"),(0,r.kt)("p",null,"To see the usage and configuration items of the command that throws custom exceptions, run the following command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chaosd attack jvm exception --help\n")),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"throw specified exception for specified method\n\nUsage:\n  chaosd attack jvm exception [options] [flags]\n\nFlags:\n  -c, --class string       Java class name\n      --exception string   the exception which needs to throw for action 'exception'\n  -h, --help               help for exception\n  -m, --method string      the method name in Java class\n\nGlobal Flags:\n      --log-level string   the log level of chaosd. The value can be 'debug', 'info', 'warn' and 'error'\n      --pid int            the pid of Java process which needs to attach\n      --port int           the port of agent server (default 9288)\n      --uid string         the experiment ID\n")),(0,r.kt)("h4",{id:"configuration-description-for-throwing-custom-exceptions"},"Configuration description for throwing custom exceptions"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Configuration item"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Abbreviation"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"class")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"c")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The name of the Java class"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"exception")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The thrown custom exception"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"method"),(0,r.kt)("td",{parentName:"tr",align:"left"},"m"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The name of the method"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type, required to be configured")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"pid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The Java process ID where the fault is to be injected"),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"port")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The port number attached to the Java process agent. The fault is injected into the Java process through this port number."),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type. The default value is ",(0,r.kt)("inlineCode",{parentName:"td"},"9288"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"uid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The experiment ID"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type. This item is not required to be configured, because Chaosd randomly creates one.")))),(0,r.kt)("h4",{id:"example-for-throwing-custom-exceptions"},"Example for throwing custom exceptions"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chaosd attack jvm exception -c Main -m sayhello --exception 'java.io.IOException(\"BOOM\")' --pid 30045\n")),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'[2021/08/05 02:39:39.106 +00:00] [INFO] [jvm.go:208] ["byteman rule"] [rule="\\nRULE Main-sayhello-exception-q6nd0\\nCLASS Main\\nMETHOD sayhello\\nAT ENTRY\\nIF true\\nDO \\n\\tthrow new java.io.IOException(\\"BOOM\\");\\nENDRULE\\n"] [file=/tmp/rule.btm296930759]\nAttack jvm successfully, uid: 26a45ae2-d395-46f5-a126-2b2c6c85ae9d\n')),(0,r.kt)("h3",{id:"trigger-garbage-collection-using-the-command-line-mode"},"Trigger garbage collection using the command-line mode"),(0,r.kt)("h4",{id:"commands-for-triggering-garbage-collection"},"Commands for triggering garbage collection"),(0,r.kt)("p",null,"To see the usage and configuration items of the command that triggers garbage collection, run the following command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chaosd attack jvm gc --help\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"trigger GC for JVM\n\nUsage:\n  chaosd attack jvm gc [flags]\n\nFlags:\n  -h, --help   help for gc\n\nGlobal Flags:\n      --log-level string   the log level of chaosd. The value can be 'debug', 'info', 'warn' and 'error'\n      --pid int            the pid of Java process which needs to attach\n      --port int           the port of agent server (default 9288)\n      --uid string         the experiment ID\n")),(0,r.kt)("h4",{id:"configuration-description-for-triggering-garbage-collection"},"Configuration description for triggering garbage collection"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Configuration item"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Abbreviation"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"pid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The Java process ID where the fault is to be injected"),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"port")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The port number attached to the Java process agent. The fault is injected into the Java process through this port number."),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type. The default value is ",(0,r.kt)("inlineCode",{parentName:"td"},"9288"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"uid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The experiment ID"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type. This item is not required to be configured, because Chaosd randomly creates one.")))),(0,r.kt)("h4",{id:"example-for-triggering-garbage-collection"},"Example for triggering garbage collection"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chaosd attack jvm gc --pid 89345\n")),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'[2021/08/05 02:49:47.850 +00:00] [INFO] [jvm.go:208] ["byteman rule"] [rule="\\nRULE --gc-u0mlf\\nGC\\nENDRULE\\n"] [file=/tmp/rule.btm012481052]\nAttack jvm successfully, uid: f360e70a-5359-49b6-8526-d7e0a3c6f696\n')),(0,r.kt)("p",null,"Triggering garbage collection is a one-time operation, and the experiment does not require recovery."),(0,r.kt)("h3",{id:"increase-method-latency-using-the-command-line-mode"},"Increase method latency using the command-line mode"),(0,r.kt)("h4",{id:"commands-for-increasing-method-latency"},"Commands for increasing method latency"),(0,r.kt)("p",null,"To see the usage and configuration items of the command that increases method latency, run the following command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chaosd attack jvm latency --help\n")),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"inject latency to specified method\n\nUsage:\n  chaosd attack jvm latency [options] [flags]\n\nFlags:\n  -c, --class string    Java class name\n  -h, --help            help for latency\n      --latency int     the latency duration, unit ms\n  -m, --method string   the method name in Java class\n\nGlobal Flags:\n      --log-level string   the log level of chaosd. The value can be 'debug', 'info', 'warn' and 'error'\n      --pid int            the pid of Java process which needs to attach\n      --port int           the port of agent server (default 9288)\n      --uid string         the experiment ID\n")),(0,r.kt)("h4",{id:"configuration-description-for-increasing-method-latency"},"Configuration description for increasing method latency"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Configuration item"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Abbreviation"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"class")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"c")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The name of the Java class"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"latency")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The duration of increasing method latency"),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type, required. The unit is milisecond.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"method")),(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"m")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The name of the method"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"pid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The Java process ID where the fault is to be injected"),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"port")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The port number attached to the Java process agent. The fault is injected into the Java process through this port number."),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type. The default value is ",(0,r.kt)("inlineCode",{parentName:"td"},"9288"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"uid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The experiment ID"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type. This item is not required to be configured, because Chaosd randomly creates one.")))),(0,r.kt)("h4",{id:"example-for-increasing-method-latency"},"Example for increasing method latency"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chaosd attack jvm latency --class Main --method sayhello --latency 5000 --pid 100840\n")),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'[2021/08/05 03:08:50.716 +00:00] [INFO] [jvm.go:208] ["byteman rule"] [rule="\\nRULE Main-sayhello-latency-hlib2\\nCLASS Main\\nMETHOD sayhello\\nAT ENTRY\\nIF true\\nDO \\n\\tThread.sleep(5000);\\nENDRULE\\n"] [file=/tmp/rule.btm359997255]\n[2021/08/05 03:08:51.155 +00:00] [INFO] [jvm.go:94] ["submit rules"] [output="install rule Main-sayhello-latency-hlib2\\n\\n"]\nAttack jvm successfully, uid: bbe00c57-ac9d-4113-bf0c-2a6f184be261\n')),(0,r.kt)("h3",{id:"modify-return-values-of-a-method-using-the-command-line-mode"},"Modify return values of a method using the command-line mode"),(0,r.kt)("h4",{id:"commands-for-modifying-return-values-of-a-method"},"Commands for modifying return values of a method"),(0,r.kt)("p",null,"To see the usage and configuration items of the command that modifies return values of a method, run the following command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chaosd attack jvm return --help\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"return specified value for specified method\n\nUsage:\n  chaosd attack jvm return [options] [flags]\n\nFlags:\n  -c, --class string    Java class name\n  -h, --help            help for return\n  -m, --method string   the method name in Java class\n      --value string    the return value for action 'return'. Only supports number and string types.\n\nGlobal Flags:\n      --log-level string   the log level of chaosd. The value can be 'debug', 'info', 'warn' and 'error'\n      --pid int            the pid of Java process which needs to attach\n      --port int           the port of agent server (default 9288)\n      --uid string         the experiment ID\n")),(0,r.kt)("h4",{id:"configuration-description-for-modifying-return-values-of-a-method"},"Configuration description for modifying return values of a method"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Configuration item"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Abbreviation"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"class"),(0,r.kt)("td",{parentName:"tr",align:"left"},"c"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The name of the Java class"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type, required to be configured")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"method"),(0,r.kt)("td",{parentName:"tr",align:"left"},"m"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The name of the method"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type, required to be configured")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"value"),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Specifies the return value of the method"),(0,r.kt)("td",{parentName:"tr",align:"left"},'string type, required to be configured. Currently, the item can be numeric and string types. If the item (return value) is string, double quotes are required, like "chaos".')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"pid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The Java process ID where the fault is needed to be injected"),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type, required to be configured")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"port"),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The port number attached to the Java process agent. The faults is injected into the Java process through this port number."),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type. The default value is ",(0,r.kt)("inlineCode",{parentName:"td"},"9288"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},"uid"),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The experiment ID"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type. This item is not required to be configured, because Chaosd randomly creates one.")))),(0,r.kt)("h4",{id:"example-for-simulating-the-scenario-of-modifying-return-values-of-a-method"},"Example for simulating the scenario of modifying return values of a method"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chaosd attack jvm return --class Main --method getnum --value 999 --pid 112694\n")),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'[2021/08/05 03:35:10.603 +00:00] [INFO] [jvm.go:208] ["byteman rule"] [rule="\\nRULE Main-getnum-return-i6gb7\\nCLASS Main\\nMETHOD getnum\\nAT ENTRY\\nIF true\\nDO \\n\\treturn 999;\\nENDRULE\\n"] [file=/tmp/rule.btm051982059]\n[2021/08/05 03:35:10.820 +00:00] [INFO] [jvm.go:94] ["submit rules"] [output="install rule Main-getnum-return-i6gb7\\n\\n"]\nAttack jvm successfully, uid: e2f204f6-4bed-4d92-aade-2b4a47b02e5d\n')),(0,r.kt)("h3",{id:"trigger-faults-by-setting-byteman-configuration-files-using-the-command-line-mode"},"Trigger faults by setting Byteman configuration files using the command-line mode"),(0,r.kt)("p",null,"You can set the fault rules in the Byteman rule configuration file, and then inject the faults by specifying the path of the configuration file using Chaosd. Regarding the Byteman rule configuration, refer to ",(0,r.kt)("a",{parentName:"p",href:"https://downloads.jboss.org/byteman/4.0.16/byteman-programmers-guide.html#the-byteman-rule-language"},"byteman-rule-language"),"."),(0,r.kt)("h4",{id:"commands-for-triggering-faults-by-setting-byteman-configuration-files"},"Commands for triggering faults by setting Byteman configuration files"),(0,r.kt)("p",null,"To see the usage and configuration items of the command that triggers faults by setting Byteman configuration files, run the following command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chaosd attack jvm rule-file --help\n")),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"inject fault with configured byteman rule file\n\nUsage:\n  chaosd attack jvm rule-file [options] [flags]\n\nFlags:\n  -h, --help          help for rule-file\n  -p, --path string   the path of configured byteman rule file\n\nGlobal Flags:\n      --log-level string   the log level of chaosd, the value can be 'debug', 'info', 'warn' and 'error'\n      --pid int            the pid of Java process which needs to attach\n      --port int           the port of agent server (default 9288)\n      --uid string         the experiment ID\n")),(0,r.kt)("h4",{id:"configuration-description-for-triggering-faults-by-setting-byteman-configuration-files"},"Configuration description for triggering faults by setting Byteman configuration files"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Configuration item"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Abbreviation"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"path")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"Specifies the path of the Byteman configuration file"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"pid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The Java process ID where the fault is to be injected"),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"port")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The port number attached to the Java process agent. The fault is injected into the Java process through this port number."),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type. The default value is ",(0,r.kt)("inlineCode",{parentName:"td"},"9288"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"uid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The experiment ID"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type. This item is not required to be configured, because Chaosd randomly creates one.")))),(0,r.kt)("h4",{id:"example-for-triggering-faults-by-setting-byteman-configuration-files"},"Example for triggering faults by setting Byteman configuration files"),(0,r.kt)("p",null,"First, based on the specific Java program and referring to ",(0,r.kt)("a",{parentName:"p",href:"https://downloads.jboss.org/byteman/4.0.16/byteman-programmers-guide.html#the-byteman-rule-language"},"the Byteman rule language"),", write a rule configuration file. For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},"RULE modify return value\nCLASS Main\nMETHOD getnum\nAT ENTRY\nIF true\nDO\n    return 9999\nENDRULE\n")),(0,r.kt)("p",null,"Then, save the configuration file to the ",(0,r.kt)("inlineCode",{parentName:"p"},"return.btm")," file. After that, run the following command to inject faults."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chaosd attack jvm rule-file -p ./return.btm --pid 112694\n")),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'[2021/08/05 03:45:40.757 +00:00] [INFO] [jvm.go:152] ["rule file data:RULE modify return value\\nCLASS Main\\nMETHOD getnum\\nAT ENTRY\\nIF true\\nDO\\n    return 9999\\nENDRULE\\n"]\n[2021/08/05 03:45:41.011 +00:00] [INFO] [jvm.go:94] ["submit rules"] [output="install rule modify return value\\n\\n"]\nAttack jvm successfully, uid: 5ca2e06d-a7c6-421d-bb67-0c9908bac17a\n')),(0,r.kt)("h3",{id:"increase-jvm-stress-using-the-command-line-mode"},"Increase JVM stress using the command-line mode"),(0,r.kt)("h4",{id:"commands-for-increasing-jvm-stress"},"Commands for increasing JVM stress"),(0,r.kt)("p",null,"To see the usage and configuration items of the command that increases JVM stress, run the following command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chaosd attack jvm stress --help\n")),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"inject stress to JVM\n\nUsage:\n  chaosd attack jvm stress [options] [flags]\n\nFlags:\n      --cpu-count int   the CPU core number\n  -h, --help            help for stress\n      --mem-type int    the memory type to be allocated. The value can be 'stack' or 'heap'.\n\nGlobal Flags:\n      --log-level string   the log level of chaosd. The value can be 'debug', 'info', 'warn' and 'error'\n      --pid int            the pid of Java process which needs to attach\n      --port int           the port of agent server (default 9288)\n      --uid string         the experiment ID\n")),(0,r.kt)("h4",{id:"configuration-description-for-increasing-jvm-stress"},"Configuration description for increasing JVM stress"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Configuration item"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Abbreviation"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"cpu-count")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The number of CPU cores used for increasing JVM stress"),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type. You must configure one item between ",(0,r.kt)("inlineCode",{parentName:"td"},"cpu-count")," and ",(0,r.kt)("inlineCode",{parentName:"td"},"mem-type"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"mem-type")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The type of OOM"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type. Currently, both 'stack' and 'heap' OOM types are supported. You must configure one item between ",(0,r.kt)("inlineCode",{parentName:"td"},"cpu-count")," and ",(0,r.kt)("inlineCode",{parentName:"td"},"mem-type"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"pid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The Java process ID where the fault is to be injected"),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"port")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The port number attached to the Java process agent. The fault is injected into the Java process through this port number."),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type. The default value is ",(0,r.kt)("inlineCode",{parentName:"td"},"9288"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"uid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The experiment ID"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type. This item is not required to be configured, because Chaosd randomly creates one.")))),(0,r.kt)("h4",{id:"example-for-increasing-jvm-stress"},"Example for increasing JVM stress"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chaosd attack jvm stress --cpu-count 2 --pid 123546\n")),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'[2021/08/05 03:59:51.256 +00:00] [INFO] [jvm.go:208] ["byteman rule"] [rule="\\nRULE --stress-jfeiu\\nSTRESS CPU\\nCPUCOUNT 2\\nENDRULE\\n"] [file=/tmp/rule.btm773062009]\n[2021/08/05 03:59:51.613 +00:00] [INFO] [jvm.go:94] ["submit rules"] [output="install rule --stress-jfeiu\\n\\n"]\nAttack jvm successfully, uid: b9b997b5-0a0d-4f1f-9081-d52a32318b84\n')),(0,r.kt)("h2",{id:"create-experiments-using-the-service-mode"},"Create experiments using the service mode"),(0,r.kt)("p",null,"You can follow the instructions below to create experiments using the service mode."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Execute Chaosd in service mode:"),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"chaosd server --port 31767\n"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Send HTTP POST request to the ",(0,r.kt)("inlineCode",{parentName:"p"},"/api/attack/{uid}")," path of Chaosd service."),(0,r.kt)("pre",{parentName:"li"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"curl -X POST 172.16.112.130:31767/api/attack/jvm -H \"Content-Type:application/json\" -d '{fault-configuration}'\n")),(0,r.kt)("p",{parentName:"li"},"For the ",(0,r.kt)("inlineCode",{parentName:"p"},"fault-configuration")," part in the above command, you need to configure it according to the fault types. For the corresponding parameters, refer to the parameters and examples of each fault type in the following sections."))),(0,r.kt)("admonition",{type:"note"},(0,r.kt)("p",{parentName:"admonition"},"When running an experiment, remember to save the UID information of the experiment. When you want to end the experiment corresponding to the UID, you need to send an HTTP DELETE request to the ",(0,r.kt)("inlineCode",{parentName:"p"},"/api/attack/{uid}")," path of Chaosd service.")),(0,r.kt)("h3",{id:"throw-custom-exceptions-using-the-service-mode"},"Throw custom exceptions using the service mode"),(0,r.kt)("h4",{id:"parameters-for-throwing-custom-exceptions"},"Parameters for throwing custom exceptions"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"action")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The action of the experiment"),(0,r.kt)("td",{parentName:"tr",align:"left"},'Set to "exception"')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"class")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The name of the Java class"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"exception")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The thrown custom exception"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"method")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The name of the method"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"pid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The Java process ID where the fault is to be injected"),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"port")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The port number attached to the Java process agent. The faults is injected into the Java process through this port number."),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type. The default value is ",(0,r.kt)("inlineCode",{parentName:"td"},"9288"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"uid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The experiment ID"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type. This item is not required to be configured, because Chaosd randomly creates one.")))),(0,r.kt)("h4",{id:"example-for-throwing-custom-exceptions-using-the-service-mode"},"Example for throwing custom exceptions using the service mode"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'curl -X POST 172.16.112.130:31767/api/attack/jvm -H "Content-Type:application/json" -d \'{"action":"exception","class":"Main","method":"sayhello","exception":"java.io.IOException(\\"BOOM\\")","pid":1828622}\'\n')),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'{"status":200,"message":"attack successfully","uid":"c3c519bf-819a-4a7b-97fb-e3d0814481fa"}\n')),(0,r.kt)("h3",{id:"trigger-garbage-collection-using-service-mode"},"Trigger garbage collection using service mode"),(0,r.kt)("h4",{id:"parameters-for-triggering-garbage-collection"},"Parameters for triggering garbage collection"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"action")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The action of the experiment"),(0,r.kt)("td",{parentName:"tr",align:"left"},'Set to "gc"')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"pid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The Java process ID where the fault is to be injected"),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"port")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The port number attached to the Java process agent. The fault is injected into the Java process through this port number."),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type. The default value is ",(0,r.kt)("inlineCode",{parentName:"td"},"9288"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"uid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The experiment ID"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type. This item is not required to be configured, because Chaosd randomly creates one.")))),(0,r.kt)("h4",{id:"example-for-triggering-garbage-collection-using-the-service-mode"},"Example for triggering garbage collection using the service mode"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'curl -X POST 172.16.112.130:31767/api/attack/jvm -H "Content-Type:application/json" -d \'{"action":"gc","pid":1828622}\'\n')),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'{"status":200,"message":"attack successfully","uid":"c3c519bf-819a-4a7b-97fb-e3d0814481fa"}\n')),(0,r.kt)("p",null,"Triggering garbage collection is a one-time operation. The experiment does not require recovery."),(0,r.kt)("h3",{id:"increase-method-latency-using-service-mode"},"Increase method latency using service mode"),(0,r.kt)("h4",{id:"parameters-for-increasing-method-latency"},"Parameters for increasing method latency"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"action")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The action of the experiment"),(0,r.kt)("td",{parentName:"tr",align:"left"},'Set to "latency"')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"class")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The name of the Java class"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"latency")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The duration of increasing method latency"),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type, required. The unit is milisecond.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"method")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The name of the method"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"pid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The Java process ID where the fault is to be injected"),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"port")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The Java process ID where the fault is needed to be injected"),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"uid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The experiment ID"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type. This item is not required to be configured, because Chaosd randomly creates one.")))),(0,r.kt)("h4",{id:"example-for-increasing-method-latency-using-the-service-mode"},"Example for increasing method latency using the service mode"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'curl -X POST 172.16.112.130:31767/api/attack/jvm -H "Content-Type:application/json" -d \'{"action":"latency","class":"Main","method":"sayhello","latency":5000,"pid":1828622}\'\n')),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'{"status":200,"message":"attack successfully","uid":"a551206c-960d-4ac5-9056-518e512d4d0d"}\n')),(0,r.kt)("h3",{id:"modify-return-values-of-a-method-using-service-mode"},"Modify return values of a method using service mode"),(0,r.kt)("h4",{id:"parameters-for-modifying-return-values-of-a-method"},"Parameters for modifying return values of a method"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"action")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The action of the experiment"),(0,r.kt)("td",{parentName:"tr",align:"left"},'Set to "return"')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"class")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The name of the Java class"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"method")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The name of the method"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"value")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Specifies the return value of the method"),(0,r.kt)("td",{parentName:"tr",align:"left"},'string type, required. Currently, the item can be numeric and string types. If the item (return value) is string, double quotes are required, like "chaos".')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"pid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The Java process ID where the fault is to be injected"),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"port")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The port number attached to the Java process agent. The fault is injected into the Java process through this port number."),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type. The default value is ",(0,r.kt)("inlineCode",{parentName:"td"},"9288"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"uid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The experiment ID"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type. This item is not required to be configured, because Chaosd randomly creates one.")))),(0,r.kt)("h4",{id:"example-for-modifying-return-values-of-a-method-using-the-service-mode"},"Example for modifying return values of a method using the service mode"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'curl -X POST 172.16.112.130:31767/api/attack/jvm -H "Content-Type:application/json" -d \'{"action":"return","class":"Main","method":"getnum","value":"999","pid":1828622}\'\n')),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'{"status":200,"message":"attack successfully","uid":"a551206c-960d-4ac5-9056-518e512d4d0d"}\n')),(0,r.kt)("h3",{id:"trigger-faults-by-setting-byteman-configuration-files-using-service-mode"},"Trigger faults by setting Byteman configuration files using service mode"),(0,r.kt)("p",null,"You can set the fault rules according to the Byteman rule configuration. Regarding to the Byteman rule configuration, refer to ",(0,r.kt)("a",{parentName:"p",href:"https://downloads.jboss.org/byteman/4.0.16/byteman-programmers-guide.html#the-byteman-rule-language"},"byteman-rule-language"),"."),(0,r.kt)("h4",{id:"parameters-for-triggering-faults-by-setting-byteman-configuration-files"},"Parameters for triggering faults by setting Byteman configuration files"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Value"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"action")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The action of the experiment"),(0,r.kt)("td",{parentName:"tr",align:"left"},'Set to "rule-data"')),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"rule-data")),(0,r.kt)("td",{parentName:"tr",align:"left"},"Specifies the Byteman configuration data"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"pid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The Java process ID where the fault is to be injected"),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"port")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The port number attached to the Java process agent. The fault is injected into the Java process through this port number."),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type. The default value is ",(0,r.kt)("inlineCode",{parentName:"td"},"9288"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"uid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The experiment ID"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type. This item is not required to be configured, because Chaosd randomly creates one.")))),(0,r.kt)("h4",{id:"example-for-triggering-faults-by-setting-byteman-configuration-files-using-the-service-mode"},"Example for triggering faults by setting Byteman configuration files using the service mode"),(0,r.kt)("p",null,"First, based on the specific Java program and referring to ",(0,r.kt)("a",{parentName:"p",href:"https://downloads.jboss.org/byteman/4.0.16/byteman-programmers-guide.html#the-byteman-rule-language"},"the Byteman rule language"),", write a rule configuration file. For example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-txt"},"RULE modify return value\nCLASS Main\nMETHOD getnum\nAT ENTRY\nIF true\nDO\n    return 9999\nENDRULE\n")),(0,r.kt)("p",null,'Then, escape the line breaks in the configuration file to the newline character "\\n", and use the escaped text as the value of "rule-data". Run the following command:'),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'curl -X POST 127.0.0.1:31767/api/attack/jvm -H "Content-Type:application/json" -d \'{"action":"rule-data","pid":30045,"rule-data":"\\nRULE modify return value\\nCLASS Main\\nMETHOD getnum\\nAT ENTRY\\nIF true\\nDO return 9999\\nENDRULE\\n"}\'\n')),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'{"status":200,"message":"attack successfully","uid":"a551206c-960d-4ac5-9056-518e512d4d0d"}\n')),(0,r.kt)("h3",{id:"increase-jvm-stress-using-the-service-mode"},"Increase JVM stress using the service mode"),(0,r.kt)("h4",{id:"parameters-for-increasing-jvm-stress"},"Parameters for increasing JVM stress"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:"left"},"Parameter"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Description"),(0,r.kt)("th",{parentName:"tr",align:"left"},"Value"),(0,r.kt)("th",{parentName:"tr",align:null}))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"action")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The action of the experiment"),(0,r.kt)("td",{parentName:"tr",align:"left"},'Set to "stress"'),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"cpu-count")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The number of CPU cores used for increasing CPU stress"),(0,r.kt)("td",{parentName:"tr",align:"left"},"int type. You must configure one item between ",(0,r.kt)("inlineCode",{parentName:"td"},"cpu-count")," and ",(0,r.kt)("inlineCode",{parentName:"td"},"mem-type"),"."),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"mem-type")),(0,r.kt)("td",{parentName:"tr",align:"left"},"The type of OOM"),(0,r.kt)("td",{parentName:"tr",align:"left"},"string type. Currently, both 'stack' and 'heap' OOM types are supported. You must configure one item between ",(0,r.kt)("inlineCode",{parentName:"td"},"cpu-count")," and ",(0,r.kt)("inlineCode",{parentName:"td"},"mem-type"),"."),(0,r.kt)("td",{parentName:"tr",align:null})),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"pid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The Java process ID where the fault is to be injected"),(0,r.kt)("td",{parentName:"tr",align:null},"int type, required")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"port")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The port number attached to the Java process agent. The fault is injected into the Java process through this port number."),(0,r.kt)("td",{parentName:"tr",align:null},"int type. The default value is ",(0,r.kt)("inlineCode",{parentName:"td"},"9288"),".")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:"left"},(0,r.kt)("inlineCode",{parentName:"td"},"uid")),(0,r.kt)("td",{parentName:"tr",align:"left"},"None"),(0,r.kt)("td",{parentName:"tr",align:"left"},"The experiment ID"),(0,r.kt)("td",{parentName:"tr",align:null},"string type. This item is not required to be configured, because Chaosd randomly creates one.")))),(0,r.kt)("h4",{id:"example-for-increasing-jvm-stress-using-the-service-mode"},"Example for increasing JVM stress using the service mode"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'curl -X POST 172.16.112.130:31767/api/attack/jvm -H "Content-Type:application/json" -d \'{"action":"stress","cpu-count":1,"pid":1828622}\'\n')),(0,r.kt)("p",null,"The result is as follows:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'{"status":200,"message":"attack successfully","uid":"a551206c-960d-4ac5-9056-518e512d4d0d"}\n')))}p.isMDXComponent=!0}}]);