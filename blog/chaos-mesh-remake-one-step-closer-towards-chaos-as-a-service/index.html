<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Chaos MeshÂ® Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Chaos MeshÂ® Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-90760217-2","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="search" type="application/opensearchdescription+xml" title="Chaos MeshÂ®" href="/opensearch.xml"><title data-react-helmet="true">Chaos Mesh Remake: One Step Closer toward Chaos as a Service | Chaos MeshÂ®</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://chaos-mesh.org/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service/"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Chaos Mesh Remake: One Step Closer toward Chaos as a Service | Chaos MeshÂ®"><meta data-react-helmet="true" name="description" content="Chaos engineering tools"><meta data-react-helmet="true" property="og:description" content="Chaos engineering tools"><meta data-react-helmet="true" property="og:image" content="https://chaos-mesh.org/img/chaos-engineering-tools-as-a-service.jpeg"><meta data-react-helmet="true" name="twitter:image" content="https://chaos-mesh.org/img/chaos-engineering-tools-as-a-service.jpeg"><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2021-06-25T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://github.com/chaos-mesh/chaos-mesh/blob/master/MAINTAINERS.md"><meta data-react-helmet="true" property="article:tag" content="Chaos Mesh,Chaos Engineering"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://chaos-mesh.org/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service/"><link data-react-helmet="true" rel="alternate" href="https://chaos-mesh.org/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://chaos-mesh.org/zh/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service/" hreflang="zh"><link data-react-helmet="true" rel="alternate" href="https://chaos-mesh.org/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service/" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.50757113.css">
<link rel="preload" href="/assets/js/runtime~main.b86104c0.js" as="script">
<link rel="preload" href="/assets/js/main.de204a7d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><div class="announcementBar_3WsW" style="background-color:#37b5fb" role="banner"><div class="announcementBarPlaceholder_2m9F"></div><div class="announcementBarContent_3EUC">Chaos Mesh 2.0 was released in July, 2021, see <a href="/blog/chaos-mesh-2.0-to-a-chaos-engineering-ecology">what's new</a>!</div><button type="button" class="clean-btn close announcementBarClose_38nx" aria-label="Close"><svg viewBox="0 0 24 24" width="14" height="14" fill="currentColor"><path d="M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z"></path></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_2qcr"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logos/logo-mini.svg" alt="Chaos Mesh" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logos/logo-mini-white.svg" alt="Chaos Mesh" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Chaos MeshÂ®</b></a><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" href="/docs/">2.0.2</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/next/">Next</a></li><li><a class="dropdown__link" href="/docs/">2.0.2</a></li><li><a class="dropdown__link" href="/docs/1.2.3/">1.2.3</a></li><li><a class="dropdown__link" href="/docs/1.1.4/">1.1.4</a></li><li><a class="dropdown__link" href="/docs/1.0.3/">1.0.3</a></li><li><a class="dropdown__link" href="/docs/0.9.1/">0.9.1</a></li></ul></div><a class="navbar__item navbar__link" href="/docs/">Documentation</a><a class="navbar__item navbar__link" href="/interactive-tutorial/">Interactive Tutorial</a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog/">Blog</a><a href="https://community.cncf.io/chaos-mesh-community/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Events<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_3vod"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">English</a></li><li><a href="/zh/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service/" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">ç®€ä½“ä¸­æ–‡</a></li></ul></div><a href="https://github.com/chaos-mesh/chaos-mesh" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub"></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_1Doo"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_2ahu thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_2hhb margin-bottom--md">Recent posts</div><ul class="sidebarItemList_2xAf"><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/chaos-mesh-hacktoberfest-2021/">Hacktoberfest 2021: hack with Chaos Mesh!</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/run-chaos-experiments-on-physical-machines/">How to run chaos experiments on your physical machine</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/Securing-Online-Gaming-Combine-Chaos-Engineering-with-DevOps-Practices/">Securing Online Gaming: Combine Chaos Engineering with DevOps Practices</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/How-Chaos-Mesh-Helps-Apache-APISIX-Improve-System-Stability/">How Chaos Mesh Helps Apache APISIX Improve System Stability</a></li><li class="sidebarItem_2UVv"><a class="sidebarItemLink_1RT6" href="/blog/chaos-mesh-2.0-to-a-chaos-engineering-ecology/">Chaos Mesh 2.0: To a Chaos Engineering Ecology</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_GeHD" itemprop="headline">Chaos Mesh Remake: One Step Closer toward Chaos as a Service</h1><div class="blogPostData_291c margin-vert--md"><time datetime="2021-06-25T00:00:00.000Z" itemprop="datePublished">June 25, 2021</time> Â· 11 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_1R69"><div class="avatar margin-bottom--sm"><a href="https://github.com/chaos-mesh/chaos-mesh/blob/master/MAINTAINERS.md" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_1yU8" src="https://avatars1.githubusercontent.com/u/59082378?v=4" alt="Chang Yu, Xiang Wang"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/chaos-mesh/chaos-mesh/blob/master/MAINTAINERS.md" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Chang Yu, Xiang Wang</span></a></div><small class="avatar__subtitle" itemprop="description">Contributor of Chaos Mesh</small></div></div></div></div></header><meta itemprop="image" content="https://chaos-mesh.org/img/chaos-engineering-tools-as-a-service.jpeg"><div class="markdown" itemprop="articleBody"><p><img alt="Chaos engineering tools" src="/assets/images/chaos-engineering-tools-as-a-service-018f1130dab4f321b60a8eccd366c0e1.jpeg"></p><p><a href="https://chaos-mesh.org/" target="_blank" rel="noopener noreferrer">Chaos MeshÂ®</a> is a cloud-native Chaos Engineering platform that orchestrates chaos in Kubernetes environments. With Chaos Mesh, you can test your system&#x27;s resilience and robustness on Kubernetes by injecting all types of faults into Pods, network, file system, and even the kernel.</p><p>Since it was open-sourced and accepted by the Cloud Native Computing Foundation (CNCF) as a sandbox project, Chaos Mesh has attracted contributors worldwide and helped users test their systems. Yet it still has a lot of room for improvement:</p><ul><li>It needs to improve usability. Some features are complicated to use. For example, when you apply a chaos experiment, you often have to manually check whether the experiment has started.</li><li>It is mostly for Kubernetes environments. Because Chaos Mesh can&#x27;t manage multiple Kubernetes clusters, you need to deploy Chaos Mesh for each Kubernetes cluster. Though <a href="https://github.com/chaos-mesh/chaosd" target="_blank" rel="noopener noreferrer">chaosd</a> supports running chaos experiments on physical machines, the features are quite limited, and command line usage is not user friendly.</li><li>It doesn&#x27;t allow plugins. To apply a customized chaos experiment, you have to alter the source code. Moreover, Chaos Mesh only supports Golang.</li></ul><p>Admittedly, Chaos Mesh is a first-rate Chaos Engineering platform, but is still a long way from offering Chaos as a Service (CaaS). Therefore, at <a href="https://pingcap.com/community/events/hackathon2020/" target="_blank" rel="noopener noreferrer">TiDB Hackathon 2020</a>, <strong>we made changes to Chaos Mesh&#x27;s architecture, moving it one step closer toward CaaS</strong>.</p><p>In this article, I&#x27;ll talk about what CaaS is, how we achieve it with Chaos Mesh, and our plans and lessons learned. I hope you find our experience helpful in building your own Chaos Engineering system.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3R7-" id="what-is-chaos-as-a-service"></a>What is Chaos as a Service?<a class="hash-link" href="#what-is-chaos-as-a-service" title="Direct link to heading">#</a></h2><p>As Matt Fornaciari, co-founder of Gremlin, <a href="https://jaxenter.com/chaos-engineering-service-144113.html" target="_blank" rel="noopener noreferrer">puts it</a>, CaaS &quot;means you will get an intuitive UI, customer support, out-of-the-box integrations, and everything else you need to get experimenting in a matter of minutes.&quot;</p><p>From our perspective, CaaS should offer:</p><ul><li>A unified console for management, where you can edit the configuration and create chaos experiments.</li><li>Visualized metrics for you to see the experiment status.</li><li>Operations to pause or archive experiments.</li><li>Simple interaction. You can easily drag and drop the objects to orchestrate your experiments.</li></ul><p>Some companies already adapted Chaos Mesh to meet their own needs, such as <a href="https://pingcap.com/blog/how-a-top-game-company-uses-chaos-engineering-to-improve-testing" target="_blank" rel="noopener noreferrer">NetEase Fuxi AI Lab</a> and FreeWheel, making it a mock-up for CaaS.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3R7-" id="developing-chaos-mesh-towards-caas"></a>Developing Chaos Mesh towards CaaS<a class="hash-link" href="#developing-chaos-mesh-towards-caas" title="Direct link to heading">#</a></h2><p>Based on our understanding of CaaS, we refined the architecture of Chaos Mesh during Hackathon, including improved support for different systems and better observability. You can check out our code in <a href="https://github.com/wuntun/chaos-mesh/tree/caas" target="_blank" rel="noopener noreferrer">wuntun/chaos-mesh</a> and <a href="https://github.com/wuntun/chaosd/tree/caas" target="_blank" rel="noopener noreferrer">wuntun/chaosd</a>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="refactor-chaos-dashboard"></a>Refactor Chaos Dashboard<a class="hash-link" href="#refactor-chaos-dashboard" title="Direct link to heading">#</a></h3><p>The current Chaos Mesh architecture is suited for individual Kubernetes clusters. Chaos Dashboard, the web UI, is bound to a specified Kubernetes environment:</p><p><img alt="Chaos Mesh architecture" src="/assets/images/chaos-mesh-remake-architecture-11dd1c3b15d9508739904ec7571972fb.jpeg"></p><p class="caption-center">The current Chaos Mesh architecture</p><p>During this refactor, <strong>to allow Chaos Dashboard to manage multiple Kubernetes clusters, we separate Chaos Dashboard from the main architecture</strong>. Now, if you deploy Chaos Dashboard outside of the Kubernetes cluster, you can add the cluster to Chaos Dashboard via the web UI. If you deploy Chaos Dashboard inside the cluster, it automatically obtains the cluster information through environment variables.</p><p>You can register Chaos Mesh (technically, the Kubernetes configuration) in Chaos Dashboard or ask <code>chaos-controller-manager</code> to report to Chaos Dashboard via configuration. Chaos Dashboard and <code>chaos-controller-manager</code> interact via CustomResourceDefinitions (CRDs). When <code>chaos-controller-manager</code> finds a Chaos Mesh CRD event, it invokes <code>chaos-daemon</code> to carry out the related chaos experiment. Therefore, Chaos Dashboard can manage experiments by operating on CRDs.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="refactor-chaosd"></a>Refactor chaosd<a class="hash-link" href="#refactor-chaosd" title="Direct link to heading">#</a></h3><p>chaosd is a toolkit for running chaos experiments on physical machines. Previously, it was only a command line tool and had limited features.</p><p><img alt="chaosd, a Chaos Engineering command line tool" src="/assets/images/chaosd-chaos-engineering-command-line-tool-b516d67d95f896a548a90492e516e870.jpeg"></p><p class="caption-center">Previously, chaosd was a command line tool</p><p>During the refactoring, <strong>we enabled chaosd to support the RESTful API and enhanced its services so that it can configure chaos experiments by parsing CRD-format JSON or YAML files</strong>.</p><p>Now, chaosd can register itself to Chaos Dashboard via configuration and send regular heartbeats to Chaos Dashboard. With the heartbeat signals, Chaos Dashboard can manage the chaosd node status. You can also add chaosd nodes to Chaos Dashboard via the web UI.</p><p>Moreover, <strong>chaosd can now schedule chaos experiments at specified time and manage experiment lifecycles, which unifies the user experience on Kubernetes and on physical machines</strong>.</p><p>With new Chaos Dashboard and chaosd, the optimized architecture of Chaos Mesh is as follows:</p><p><img alt="Chaos Mesh&amp;#39;s optimized architecture" src="/assets/images/chaos-mesh-optimized-architecture-8887bf8ec188ff72990a48dd1b2735f8.jpeg"></p><p class="caption-center">Chaos Mesh&#x27;s optimized architecture</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="improve-observability"></a>Improve observability<a class="hash-link" href="#improve-observability" title="Direct link to heading">#</a></h3><p>Another improvement is observability, namely how to tell if an experiment is carried out successfully.</p><p>Before the improvement, you had to manually check the experiment metrics. If you injected <a href="https://chaos-mesh.org/docs/1.2.3/chaos_experiments/stresschaos_experiment" target="_blank" rel="noopener noreferrer">StressChaos</a> into a Pod, you had to enter the Pod to see if there was a <code>stress-ng</code> process and then use <code>top</code> commands to check CPU and memory utilization. These metrics told you whether your StressChaos experiment was created successfully.</p><p>To streamline the process, we now integrate <code>node_exporter</code> into <code>chaos-daemon</code> and chaosd to collect node metrics. We also deploy <code>kube-state-metrics</code> in the Kubernetes cluster, combined with cadvisor, to collect Kubernetes metrics. The collected metrics are saved and visualized by Prometheus and Grafana, which provide a simple method for you to check the experiment status.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor anchor__h4 anchorWithHideOnScrollNavbar_3R7-" id="further-improvements-needed"></a>Further improvements needed<a class="hash-link" href="#further-improvements-needed" title="Direct link to heading">#</a></h4><p>Overall, metrics aim to help you:</p><ul><li>Confirm that chaos is injected.</li><li>Observe the chaos impact on the service and make periodic analysis.</li><li>Respond to exceptional chaos events.</li></ul><p>To achieve these goals, the system needs to monitor the experiment data metrics, the ordinary metrics, and the experiment events. Chaos Mesh still needs to improve:</p><ul><li>Experiment data metrics, such as the exact latency duration of the injected network latency and the specific load of the simulated workload.</li><li>Experiment events; that is, the Kubernetes events of creating, deleting, and running experiments.</li></ul><p>Here is a good example of metrics from <a href="https://github.com/litmuschaos/chaos-exporter#example-metrics" target="_blank" rel="noopener noreferrer">Litmus</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3R7-" id="other-proposals-for-chaos-mesh"></a>Other proposals for Chaos Mesh<a class="hash-link" href="#other-proposals-for-chaos-mesh" title="Direct link to heading">#</a></h2><p>Because of the limited time at Hackathon, we didn&#x27;t finish all our plans. Here are some of our proposals for the Chaos Mesh community to consider in the future.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="orchestration"></a>Orchestration<a class="hash-link" href="#orchestration" title="Direct link to heading">#</a></h3><p>A closed loop of Chaos Engineering includes four steps: exploring chaos, discovering deficiencies in the system, analyzing root causes, and sending feedback for improvement.</p><p><img alt="A closed loop of Chaos Engineering" src="/assets/images/closed-loop-of-chaos-engineering-3dc83a5a0d542f1cb6a873130b48bd22.jpeg"></p><p class="caption-center">A closed loop of Chaos Engineering</p><p>However, <strong>most of the current open source Chaos Engineering tools only focus on exploration and do not provide pragmatic feedback.</strong> Based on the improved observability component, we can monitor chaos experiments in real time and compare and analyze the experiment results.</p><p>With these results, we will be able to realize a closed loop by adding another important component: orchestration. The Chaos Mesh community already proposed a <a href="https://github.com/chaos-mesh/rfcs/pull/10/files" target="_blank" rel="noopener noreferrer">Workflow</a> feature, which enables you to easily orchestrate and call back chaos experiments or conveniently integrate Chaos Mesh with other systems. You can run chaos experiments in the CI/CD phase or after a canary release.</p><p><strong>Combining observability and orchestration makes a closed feedback loop for Chaos Engineering.</strong> If you were to launch a 100 ms network latency test on a Pod, you could observe the latency change using the observability component and check if the Pod service is still available using PromQL or other DSL based on orchestration. If the service was unavailable, you may conclude that the service is unavailable when the latency is &gt;= 100 ms.</p><p>But 100 ms is not the threshold of your service; you need to know what is the largest latency your service can handle. By orchestrating the value of the chaos experiment, you&#x27;ll know what is the threshold value you must ensure to meet your service-level objectives. Also, you&#x27;ll find out the service performance under different network conditions and whether they meet your expectations.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="data-format"></a>Data format<a class="hash-link" href="#data-format" title="Direct link to heading">#</a></h3><p>Chaos Mesh uses CRDs to define its chaos objects. If we can convert CRDs to JSON files, we can achieve communication between components.</p><p>In terms of data format, chaosd just consumes and registers CRD data in JSON format. If a chaos tool can consume CRD data and register itself, it can run chaos experiments in different scenarios.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="plugins"></a>Plugins<a class="hash-link" href="#plugins" title="Direct link to heading">#</a></h3><p>Chaos Mesh has limited support for plugins. You can only <a href="https://chaos-mesh.org/docs/1.2.3/development_guides/develop_a_new_chaos/" target="_blank" rel="noopener noreferrer">add a new Chaos</a> by registering a CRD in Kubernetes API. This brings about two problems:</p><ul><li>You must develop the plugin using Golang, the same language in which Chaos Mesh is written.</li><li>You must merge the extended code into the Chaos Mesh project. Because Chaos Mesh doesn&#x27;t have a security mechanism like Berkeley Packet Filter (BPF), merging plugin code may introduce extra risks.</li></ul><p>To enable full plugin support, we need to explore a new method to add plugins. As Chaos Mesh essentially carries out chaos experiments based on CRD, a chaos experiment only requires generating, listening to, and deleting CRDs. In this regard, we have several ideas worth trying:</p><ul><li>Develop a controller or operator to manage CRDs.</li><li>Handle CRD events uniformly and operate on CRDs via HTTP callback. This method only uses HTTP APIs, with no requirement on Golang. For an example, see <a href="https://github.com/summerwind/whitebox-controller" target="_blank" rel="noopener noreferrer">Whitebox Controller</a>.</li><li>Use WebAssembly (Wasm). When you need to call chaos experiment logic, just call the Wasm program. See Vector&#x27;s <a href="https://vector.dev/docs/reference/transforms/wasm/" target="_blank" rel="noopener noreferrer">WASM Transform</a>.</li><li>Use SQL to query the chaos experiment status. Because Chaos Mesh is based on CRDs, you can use SQL to operate on Kubernetes. Examples include <a href="https://github.com/xuxinkun/kubesql" target="_blank" rel="noopener noreferrer">Presto connector</a> and <a href="https://github.com/aquasecurity/kube-query" target="_blank" rel="noopener noreferrer">osquery extension</a>.</li><li>Use SDK-based extensions, such as <a href="https://docs.chaostoolkit.org/reference/api/experiment/" target="_blank" rel="noopener noreferrer">Chaos Toolkit</a>.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="integration-with-other-chaos-tools"></a>Integration with other Chaos tools<a class="hash-link" href="#integration-with-other-chaos-tools" title="Direct link to heading">#</a></h3><p>For real-world systems, a single Chaos Engineering tool can hardly exhaust all possible use cases. That&#x27;s why integrating with other chaos tools can make the Chaos Engineering ecosystem more powerful.</p><p>There are numerous Chaos Engineering tools on the market. Litmus&#x27;s <a href="https://github.com/litmuschaos/litmus-go/tree/master/chaoslib/powerfulseal" target="_blank" rel="noopener noreferrer">Kubernetes implementation</a> is based on <a href="https://github.com/powerfulseal/powerfulseal" target="_blank" rel="noopener noreferrer">PowerfulSeal</a>, while its <a href="https://github.com/litmuschaos/litmus-go/tree/master/chaoslib/pumba" target="_blank" rel="noopener noreferrer">container implementation</a> is based on <a href="https://github.com/alexei-led/pumba" target="_blank" rel="noopener noreferrer">Pumba</a>. <a href="https://github.com/cloud-bulldozer/kraken" target="_blank" rel="noopener noreferrer">Kraken</a> focuses on Kubernetes, <a href="https://github.com/amzn/awsssmchaosrunner" target="_blank" rel="noopener noreferrer">AWSSSMChaosRunner</a> focuses on AWS, and <a href="https://github.com/shopify/toxiproxy" target="_blank" rel="noopener noreferrer">Toxiproxy</a> targets TCP. There are also merging projects based on <a href="https://docs.google.com/presentation/d/1gMlmXqH6ufnb8eNO10WqVjqrPRGAO5-1S1zjcGo1Zr4/edit#slide=id.g58453c664c_2_75" target="_blank" rel="noopener noreferrer">Envoy</a> and Istio.</p><p>To manage the various chaos tools, we may need a uniform pattern, such as <a href="https://hub.litmuschaos.io/" target="_blank" rel="noopener noreferrer">Chaos Hub</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3R7-" id="voices-from-the-community"></a>Voices from the community<a class="hash-link" href="#voices-from-the-community" title="Direct link to heading">#</a></h2><p>Here, we&#x27;d like to share how a leading cyber security company in China as well as a Chaos Mesh user, adapts Chaos Mesh to meet their needs. Their adaptation has three aspects: physical node, container, and application.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="physical-node"></a>Physical node<a class="hash-link" href="#physical-node" title="Direct link to heading">#</a></h3><ul><li>Support executing scripts on physical servers. You can configure the script directory in CRDs and run your scripts using <code>chaos-daemon</code>.</li><li>Simulate reboot, shutdown, and kernel panic using the customized script.</li><li>Shut down the node&#x27;s NIC using the customized script.</li><li>Create frequent context switching using sysbench to simulate the &quot;noisy neighbor&quot; effect.</li><li>Intercept the container&#x27;s system call using BPF&#x27;s <code>seccomp</code>. This is achieved by passing and filtering PIDs.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="container"></a>Container<a class="hash-link" href="#container" title="Direct link to heading">#</a></h3><ul><li>Randomly change the number of Deployment replicas to test if the application&#x27;s traffic is abnormal.</li><li>Embed based on CRD objects: fill Ingress objects in chaos CRDs to simulate the speed limit of the interface.</li><li>Embed based on CRD objects: fill Cilium network policy objects in chaos CRDs to simulate fluctuating network conditions.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithHideOnScrollNavbar_3R7-" id="application"></a>Application<a class="hash-link" href="#application" title="Direct link to heading">#</a></h3><ul><li>Support running customized jobs. Currently, Chaos Mesh injects chaos using <code>chaos-daemon</code>, which doesn&#x27;t guarantee fairness and affinity of scheduling. To address this issue, we can use <code>chaos-controller-manager</code> to directly create jobs for different CRDs.</li><li>Support running <a href="https://github.com/postmanlabs/newman" target="_blank" rel="noopener noreferrer">Newman</a> in customized jobs to randomly change HTTP parameters. This is to implement chaos experiments on the HTTP interface, which happens when a user performs exceptional behaviors.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithHideOnScrollNavbar_3R7-" id="summary"></a>Summary<a class="hash-link" href="#summary" title="Direct link to heading">#</a></h2><p>Traditional fault testing targets specific points in the system that are anticipated to be vulnerable. It is often an assertion: a specific condition produces a specific result.</p><p><strong>Chaos Engineering is more powerful in that it helps you discover the &quot;unknown unknowns.&quot;</strong> By exploring in the broader domain, Chaos Engineering deepens your knowledge of the system being tested and unearths new information.</p><p>To sum up, these are some of our personal thoughts and practice on Chaos Engineering and Chaos Mesh. Our Hackathon project is not ready for production yet, but we hope to shed some light on CaaS and draft a promising roadmap for Chaos Mesh. If you&#x27;re interested in building Chaos as a Service, <a href="https://slack.cncf.io/" target="_blank" rel="noopener noreferrer">join our Slack</a> (#project-chaos-mesh)!</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_3kfx"><div class="col"><b>Tags:</b><ul class="tags_2ga9 padding--none margin-left--sm"><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/blog/tags/chaos-mesh/">Chaos Mesh</a></li><li class="tag_11ep"><a class="tag_1Okp tagRegular_3MiF" href="/blog/tags/chaos-engineering/">Chaos Engineering</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/chaos-mesh/website/edit/master/blog/2021-06-25-chaos-mesh-remake-one-step-closer-toward-chaos-as-a-service.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/how-to-efficiently-stress-test-pod-memory/"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Â« How to efficiently stress test Pod memory</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/lfx-mentorship-enriching-awschaos/"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">From a Newbie in Software Engineering to a Graduated LFX-Mentee Â»</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-chaos-as-a-service" class="table-of-contents__link">What is Chaos as a Service?</a></li><li><a href="#developing-chaos-mesh-towards-caas" class="table-of-contents__link">Developing Chaos Mesh towards CaaS</a><ul><li><a href="#refactor-chaos-dashboard" class="table-of-contents__link">Refactor Chaos Dashboard</a></li><li><a href="#refactor-chaosd" class="table-of-contents__link">Refactor chaosd</a></li><li><a href="#improve-observability" class="table-of-contents__link">Improve observability</a></li></ul></li><li><a href="#other-proposals-for-chaos-mesh" class="table-of-contents__link">Other proposals for Chaos Mesh</a><ul><li><a href="#orchestration" class="table-of-contents__link">Orchestration</a></li><li><a href="#data-format" class="table-of-contents__link">Data format</a></li><li><a href="#plugins" class="table-of-contents__link">Plugins</a></li><li><a href="#integration-with-other-chaos-tools" class="table-of-contents__link">Integration with other Chaos tools</a></li></ul></li><li><a href="#voices-from-the-community" class="table-of-contents__link">Voices from the community</a><ul><li><a href="#physical-node" class="table-of-contents__link">Physical node</a></li><li><a href="#container" class="table-of-contents__link">Container</a></li><li><a href="#application" class="table-of-contents__link">Application</a></li></ul></li><li><a href="#summary" class="table-of-contents__link">Summary</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/quick-start/">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/run-a-chaos-experiment/">Run a Chaos Experiment</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/developer-guide-overview/">Developer Guide Overview</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/faqs/">FAQs</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://twitter.com/chaos_mesh" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://slack.cncf.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Slack (#project-chaos-mesh)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://community.cncf.io/chaos-mesh-community/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Events<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/chaos-mesh/chaos-mesh" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/blog/">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Others</div><ul class="footer__items"><li class="footer__item"><a href="https://www.netlify.com"><img src="https://www.netlify.com/img/global/badges/netlify-color-accent.svg" alt="Deploys by Netlify"></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
        <br>
        <strong>Â© Chaos MeshÂ® Authors 2021 | Documentation Distributed under CC-BY-4.0 </strong>
        <br>
        <br>
        Â© 2021 The Linux Foundation. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage/"> Trademark Usage</a> page.
      </div></div></div></footer></div>
<script src="/assets/js/runtime~main.b86104c0.js"></script>
<script src="/assets/js/main.de204a7d.js"></script>
</body>
</html>