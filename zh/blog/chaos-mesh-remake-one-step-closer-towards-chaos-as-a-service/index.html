<!doctype html>
<html lang="zh" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Chaos Mesh Remake: One Step Closer toward Chaos as a Service | Chaos Mesh</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://chaos-mesh.org/zh/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service/"><meta data-rh="true" property="og:locale" content="zh"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Chaos Mesh Remake: One Step Closer toward Chaos as a Service | Chaos Mesh"><meta data-rh="true" name="description" content="Chaos engineering tools"><meta data-rh="true" property="og:description" content="Chaos engineering tools"><meta data-rh="true" property="og:image" content="https://chaos-mesh.org/zh/img/blog/chaos-engineering-tools-as-a-service.jpeg"><meta data-rh="true" name="twitter:image" content="https://chaos-mesh.org/zh/img/blog/chaos-engineering-tools-as-a-service.jpeg"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2021-06-25T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/WangXiangUSTC"><meta data-rh="true" property="article:tag" content="Chaos Mesh,Chaos Engineering"><link data-rh="true" rel="icon" href="/zh/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://chaos-mesh.org/zh/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service/"><link data-rh="true" rel="alternate" href="https://chaos-mesh.org/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service/" hreflang="en"><link data-rh="true" rel="alternate" href="https://chaos-mesh.org/zh/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service/" hreflang="zh"><link data-rh="true" rel="alternate" href="https://chaos-mesh.org/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://3BY0S3HQX6-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"https://chaos-mesh.org/zh/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service","mainEntityOfPage":"https://chaos-mesh.org/zh/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service","url":"https://chaos-mesh.org/zh/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service","headline":"Chaos Mesh Remake: One Step Closer toward Chaos as a Service","name":"Chaos Mesh Remake: One Step Closer toward Chaos as a Service","description":"Chaos engineering tools","datePublished":"2021-06-25T00:00:00.000Z","author":[{"@type":"Person","name":"Xiang Wang","description":"Committer of Chaos Mesh","url":"https://github.com/WangXiangUSTC","image":"https://avatars.githubusercontent.com/u/5793595?v=4"},{"@type":"Person","name":"Chang Yu"}],"image":{"@type":"ImageObject","@id":"https://chaos-mesh.org/zh/img/blog/chaos-engineering-tools-as-a-service.jpeg","url":"https://chaos-mesh.org/zh/img/blog/chaos-engineering-tools-as-a-service.jpeg","contentUrl":"https://chaos-mesh.org/zh/img/blog/chaos-engineering-tools-as-a-service.jpeg","caption":"title image for the blog post: Chaos Mesh Remake: One Step Closer toward Chaos as a Service"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"https://chaos-mesh.org/zh/blog","name":"Blog"}}</script><link rel="alternate" type="application/rss+xml" href="/zh/blog/rss.xml" title="Chaos Mesh RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh/blog/atom.xml" title="Chaos Mesh Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-T31S4LR9LL"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-T31S4LR9LL",{})</script>



<link rel="search" type="application/opensearchdescription+xml" title="Chaos Mesh" href="/zh/opensearch.xml">

<link rel="preconnect" href="https://www.clarity.ms">
<script>!function(t,e,n,c,r,s,a){t[n]=t[n]||function(){(t[n].q=t[n].q||[]).push(arguments)},(s=e.createElement(c)).async=1,s.src="https://www.clarity.ms/tag/lggqck9srz",(a=e.getElementsByTagName(c)[0]).parentNode.insertBefore(s,a)}(window,document,"clarity","script")</script><link rel="stylesheet" href="/zh/assets/css/styles.e99cfd16.css">
<script src="/zh/assets/js/runtime~main.d4919f13.js" defer="defer"></script>
<script src="/zh/assets/js/main.61f5be85.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_VprB" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top navbarHideable_gm8K"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh/"><div class="navbar__logo"><img src="/zh/img/logos/logo-mini.svg" alt="Chaos Mesh" class="themedComponent_wXoC themedComponent--light_HvHy"><img src="/zh/img/logos/logo-mini-white.svg" alt="Chaos Mesh" class="themedComponent_wXoC themedComponent--dark_JLbL"></div><b class="navbar__title text--truncate">Chaos Mesh</b></a><a class="navbar__item navbar__link" href="/zh/docs/">文档</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh/blog/">博客</a><a href="https://community.cncf.io/chaos-mesh-community/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">社团<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_WtTX"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/zh/docs/">2.7.1</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh/docs/next/">Next</a></li><li><a class="dropdown__link" href="/zh/docs/">2.7.1</a></li><li><a class="dropdown__link" href="/zh/docs/2.6.6/">2.6.6</a></li><li><a class="dropdown__link" href="/zh/docs/2.5.2/">2.5.2</a></li><li class=""><hr style="margin: .5em 0;"></li><li><a class="dropdown__link" href="/zh/versions/">All Versions</a></li><li><a class="dropdown__link" href="/zh/supported-releases/">Supported Releases</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_xvpk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh/blog/chaos-mesh-remake-one-step-closer-towards-chaos-as-a-service/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh">简体中文</a></li></ul></div><a href="https://github.com/chaos-mesh/chaos-mesh" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub"></a><div class="toggle_JMiF colorModeToggle_VyTq"><button class="clean-btn toggleButton_R5El toggleButtonDisabled_ni1X" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_UtZQ"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_hr4M"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_lWAT"><button type="button" class="DocSearch DocSearch-Button" aria-label="搜索 (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">搜索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_ZIuv"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_eAMg thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_cVoO margin-bottom--md">最近的文章</div><div role="group"><h3 class="yearGroupHeading_Nx7u">2022</h3><ul class="sidebarItemList_bJt8 clean-list"><li class="sidebarItem_Ttzz"><a class="sidebarItemLink_TQJ7" href="/zh/blog/chaos-mesh-qa-at-kubecon-eu-2022/">Chaos Mesh Q&amp;A at KUBECON EU 2022</a></li><li class="sidebarItem_Ttzz"><a class="sidebarItemLink_TQJ7" href="/zh/blog/experience-as-a-chaos-mesh-lfx-mentee/">Experience as an LFX Mentee for Chaos Mesh</a></li><li class="sidebarItem_Ttzz"><a class="sidebarItemLink_TQJ7" href="/zh/blog/develop-a-daily-reporting-system/">How to Develop a Daily Reporting System to Track Chaos Testing Results</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_Nx7u">2021</h3><ul class="sidebarItemList_bJt8 clean-list"><li class="sidebarItem_Ttzz"><a class="sidebarItemLink_TQJ7" href="/zh/blog/share-your-chaos-mesh-story/">Share your #ChaosMeshStory!</a></li><li class="sidebarItem_Ttzz"><a class="sidebarItemLink_TQJ7" href="/zh/blog/deploy-chaos-mesh-on-kubesphere/">Deploy Chaos Mesh on KubeSphere</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_ZFnQ">Chaos Mesh Remake: One Step Closer toward Chaos as a Service</h1><div class="container_AKGX margin-vert--md"><time datetime="2021-06-25T00:00:00.000Z">2021年6月25日</time> · <!-- -->阅读需 10 分钟</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_VHX3"><div class="avatar margin-bottom--sm"><a href="https://github.com/WangXiangUSTC" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_j0s_" src="https://avatars.githubusercontent.com/u/5793595?v=4" alt="Xiang Wang"></a><div class="avatar__intro authorDetails_ou41"><div class="avatar__name"><a href="https://github.com/WangXiangUSTC" target="_blank" rel="noopener noreferrer"><span class="authorName_IzGa">Xiang Wang</span></a></div><small class="authorTitle_VR7C" title="Committer of Chaos Mesh">Committer of Chaos Mesh</small><div class="authorSocials_k6N5"></div></div></div></div><div class="col col--6 authorCol_VHX3"><div class="avatar margin-bottom--sm"><div class="avatar__intro authorDetails_ou41"><div class="avatar__name"><span class="authorName_IzGa">Chang Yu</span></div><div class="authorSocials_k6N5"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p></p><figure><img decoding="async" loading="lazy" alt="Chaos engineering tools" src="/zh/assets/images/chaos-engineering-tools-as-a-service-018f1130dab4f321b60a8eccd366c0e1.jpeg" width="3126" height="1043" class="img_xWZi"><figcaption class="text--italic text--center" style="color:var(--ifm-color-content-secondary);font-size:0.875rem">Chaos engineering tools</figcaption></figure><p></p>
<p><a href="https://chaos-mesh.org/" target="_blank" rel="noopener noreferrer">Chaos Mesh</a> is a cloud-native Chaos Engineering platform that orchestrates chaos in Kubernetes environments. With Chaos Mesh, you can test your system&#x27;s resilience and robustness on Kubernetes by injecting all types of faults into Pods, network, file system, and even the kernel.</p>
<p>Since it was open-sourced and accepted by the Cloud Native Computing Foundation (CNCF) as a sandbox project, Chaos Mesh has attracted contributors worldwide and helped users test their systems. Yet it still has a lot of room for improvement:</p>
<ul>
<li>It needs to improve usability. Some features are complicated to use. For example, when you apply a chaos experiment, you often have to manually check whether the experiment has started.</li>
<li>It is mostly for Kubernetes environments. Because Chaos Mesh can&#x27;t manage multiple Kubernetes clusters, you need to deploy Chaos Mesh for each Kubernetes cluster. Though <a href="https://github.com/chaos-mesh/chaosd" target="_blank" rel="noopener noreferrer">chaosd</a> supports running chaos experiments on physical machines, the features are quite limited, and command line usage is not user friendly.</li>
<li>It doesn&#x27;t allow plugins. To apply a customized chaos experiment, you have to alter the source code. Moreover, Chaos Mesh only supports Golang.</li>
</ul>
<p>Admittedly, Chaos Mesh is a first-rate Chaos Engineering platform, but is still a long way from offering Chaos as a Service (CaaS). Therefore, at <a href="https://pingcap.com/community-activity/tidb-hackathon-2020/" target="_blank" rel="noopener noreferrer">TiDB Hackathon 2020</a>, <strong>we made changes to Chaos Mesh&#x27;s architecture, moving it one step closer toward CaaS</strong>.</p>
<p>In this article, I&#x27;ll talk about what CaaS is, how we achieve it with Chaos Mesh, and our plans and lessons learned. I hope you find our experience helpful in building your own Chaos Engineering system.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_xHUa" id="what-is-chaos-as-a-service">What is Chaos as a Service?<a href="#what-is-chaos-as-a-service" class="hash-link" aria-label="What is Chaos as a Service?的直接链接" title="What is Chaos as a Service?的直接链接">​</a></h2>
<p>As Matt Fornaciari, co-founder of Gremlin, <a href="https://jaxenter.com/chaos-engineering-service-144113.html" target="_blank" rel="noopener noreferrer">puts it</a>, CaaS &quot;means you will get an intuitive UI, customer support, out-of-the-box integrations, and everything else you need to get experimenting in a matter of minutes.&quot;</p>
<p>From our perspective, CaaS should offer:</p>
<ul>
<li>A unified console for management, where you can edit the configuration and create chaos experiments.</li>
<li>Visualized metrics for you to see the experiment status.</li>
<li>Operations to pause or archive experiments.</li>
<li>Simple interaction. You can easily drag and drop the objects to orchestrate your experiments.</li>
</ul>
<p>Some companies already adapted Chaos Mesh to meet their own needs, such as <a href="https://pingcap.com/blog/how-a-top-game-company-uses-chaos-engineering-to-improve-testing" target="_blank" rel="noopener noreferrer">NetEase Fuxi AI Lab</a> and FreeWheel, making it a mock-up for CaaS.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_xHUa" id="developing-chaos-mesh-towards-caas">Developing Chaos Mesh towards CaaS<a href="#developing-chaos-mesh-towards-caas" class="hash-link" aria-label="Developing Chaos Mesh towards CaaS的直接链接" title="Developing Chaos Mesh towards CaaS的直接链接">​</a></h2>
<p>Based on our understanding of CaaS, we refined the architecture of Chaos Mesh during Hackathon, including improved support for different systems and better observability. You can check out our code in <a href="https://github.com/wuntun/chaos-mesh/tree/caas" target="_blank" rel="noopener noreferrer">wuntun/chaos-mesh</a> and <a href="https://github.com/wuntun/chaosd/tree/caas" target="_blank" rel="noopener noreferrer">wuntun/chaosd</a>.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_xHUa" id="refactor-chaos-dashboard">Refactor Chaos Dashboard<a href="#refactor-chaos-dashboard" class="hash-link" aria-label="Refactor Chaos Dashboard的直接链接" title="Refactor Chaos Dashboard的直接链接">​</a></h3>
<p>The current Chaos Mesh architecture is suited for individual Kubernetes clusters. Chaos Dashboard, the web UI, is bound to a specified Kubernetes environment:</p>
<p></p><figure><img decoding="async" loading="lazy" alt="Chaos Mesh architecture" src="/zh/assets/images/chaos-mesh-remake-architecture-11dd1c3b15d9508739904ec7571972fb.jpeg" width="1635" height="739" class="img_xWZi"><figcaption class="text--italic text--center" style="color:var(--ifm-color-content-secondary);font-size:0.875rem">Chaos Mesh architecture</figcaption></figure><p></p>
<p>During this refactor, <strong>to allow Chaos Dashboard to manage multiple Kubernetes clusters, we separate Chaos Dashboard from the main architecture</strong>. Now, if you deploy Chaos Dashboard outside of the Kubernetes cluster, you can add the cluster to Chaos Dashboard via the web UI. If you deploy Chaos Dashboard inside the cluster, it automatically obtains the cluster information through environment variables.</p>
<p>You can register Chaos Mesh (technically, the Kubernetes configuration) in Chaos Dashboard or ask <code>chaos-controller-manager</code> to report to Chaos Dashboard via configuration. Chaos Dashboard and <code>chaos-controller-manager</code> interact via CustomResourceDefinitions (CRDs). When <code>chaos-controller-manager</code> finds a Chaos Mesh CRD event, it invokes <code>chaos-daemon</code> to carry out the related chaos experiment. Therefore, Chaos Dashboard can manage experiments by operating on CRDs.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_xHUa" id="refactor-chaosd">Refactor chaosd<a href="#refactor-chaosd" class="hash-link" aria-label="Refactor chaosd的直接链接" title="Refactor chaosd的直接链接">​</a></h3>
<p>chaosd is a toolkit for running chaos experiments on physical machines. Previously, it was only a command line tool and had limited features.</p>
<p></p><figure><img decoding="async" loading="lazy" alt="chaosd, a Chaos Engineering command line tool" src="/zh/assets/images/chaosd-chaos-engineering-command-line-tool-b516d67d95f896a548a90492e516e870.jpeg" width="1331" height="561" class="img_xWZi"><figcaption class="text--italic text--center" style="color:var(--ifm-color-content-secondary);font-size:0.875rem">chaosd, a Chaos Engineering command line tool</figcaption></figure><p></p>
<p>During the refactoring, <strong>we enabled chaosd to support the RESTful API and enhanced its services so that it can configure chaos experiments by parsing CRD-format JSON or YAML files</strong>.</p>
<p>Now, chaosd can register itself to Chaos Dashboard via configuration and send regular heartbeats to Chaos Dashboard. With the heartbeat signals, Chaos Dashboard can manage the chaosd node status. You can also add chaosd nodes to Chaos Dashboard via the web UI.</p>
<p>Moreover, <strong>chaosd can now schedule chaos experiments at specified time and manage experiment lifecycles, which unifies the user experience on Kubernetes and on physical machines</strong>.</p>
<p>With new Chaos Dashboard and chaosd, the optimized architecture of Chaos Mesh is as follows:</p>
<p></p><figure><img decoding="async" loading="lazy" alt="Chaos Mesh&amp;#39;s optimized architecture" src="/zh/assets/images/chaos-mesh-optimized-architecture-8887bf8ec188ff72990a48dd1b2735f8.jpeg" width="1482" height="824" class="img_xWZi"><figcaption class="text--italic text--center" style="color:var(--ifm-color-content-secondary);font-size:0.875rem">Chaos Mesh&amp;#39;s optimized architecture</figcaption></figure><p></p>
<h3 class="anchor anchorWithHideOnScrollNavbar_xHUa" id="improve-observability">Improve observability<a href="#improve-observability" class="hash-link" aria-label="Improve observability的直接链接" title="Improve observability的直接链接">​</a></h3>
<p>Another improvement is observability, namely how to tell if an experiment is carried out successfully.</p>
<p>Before the improvement, you had to manually check the experiment metrics. If you injected <a href="https://chaos-mesh-website-archived.netlify.app/docs/1.2.4/chaos_experiments/stresschaos" target="_blank" rel="noopener noreferrer">StressChaos</a> into a Pod, you had to enter the Pod to see if there was a <code>stress-ng</code> process and then use <code>top</code> commands to check CPU and memory utilization. These metrics told you whether your StressChaos experiment was created successfully.</p>
<p>To streamline the process, we now integrate <code>node_exporter</code> into <code>chaos-daemon</code> and chaosd to collect node metrics. We also deploy <code>kube-state-metrics</code> in the Kubernetes cluster, combined with cadvisor, to collect Kubernetes metrics. The collected metrics are saved and visualized by Prometheus and Grafana, which provide a simple method for you to check the experiment status.</p>
<h4 class="anchor anchorWithHideOnScrollNavbar_xHUa" id="further-improvements-needed">Further improvements needed<a href="#further-improvements-needed" class="hash-link" aria-label="Further improvements needed的直接链接" title="Further improvements needed的直接链接">​</a></h4>
<p>Overall, metrics aim to help you:</p>
<ul>
<li>Confirm that chaos is injected.</li>
<li>Observe the chaos impact on the service and make periodic analysis.</li>
<li>Respond to exceptional chaos events.</li>
</ul>
<p>To achieve these goals, the system needs to monitor the experiment data metrics, the ordinary metrics, and the experiment events. Chaos Mesh still needs to improve:</p>
<ul>
<li>Experiment data metrics, such as the exact latency duration of the injected network latency and the specific load of the simulated workload.</li>
<li>Experiment events; that is, the Kubernetes events of creating, deleting, and running experiments.</li>
</ul>
<p>Here is a good example of metrics from <a href="https://github.com/litmuschaos/chaos-exporter#example-metrics" target="_blank" rel="noopener noreferrer">Litmus</a>.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_xHUa" id="other-proposals-for-chaos-mesh">Other proposals for Chaos Mesh<a href="#other-proposals-for-chaos-mesh" class="hash-link" aria-label="Other proposals for Chaos Mesh的直接链接" title="Other proposals for Chaos Mesh的直接链接">​</a></h2>
<p>Because of the limited time at Hackathon, we didn&#x27;t finish all our plans. Here are some of our proposals for the Chaos Mesh community to consider in the future.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_xHUa" id="orchestration">Orchestration<a href="#orchestration" class="hash-link" aria-label="Orchestration的直接链接" title="Orchestration的直接链接">​</a></h3>
<p>A closed loop of Chaos Engineering includes four steps: exploring chaos, discovering deficiencies in the system, analyzing root causes, and sending feedback for improvement.</p>
<p></p><figure><img decoding="async" loading="lazy" alt="A closed loop of Chaos Engineering" src="/zh/assets/images/closed-loop-of-chaos-engineering-3dc83a5a0d542f1cb6a873130b48bd22.jpeg" width="1338" height="484" class="img_xWZi"><figcaption class="text--italic text--center" style="color:var(--ifm-color-content-secondary);font-size:0.875rem">A closed loop of Chaos Engineering</figcaption></figure><p></p>
<p>However, <strong>most of the current open source Chaos Engineering tools only focus on exploration and do not provide pragmatic feedback.</strong> Based on the improved observability component, we can monitor chaos experiments in real time and compare and analyze the experiment results.</p>
<p>With these results, we will be able to realize a closed loop by adding another important component: orchestration. The Chaos Mesh community already proposed a <a href="https://github.com/chaos-mesh/rfcs/pull/10/files" target="_blank" rel="noopener noreferrer">Workflow</a> feature, which enables you to easily orchestrate and call back chaos experiments or conveniently integrate Chaos Mesh with other systems. You can run chaos experiments in the CI/CD phase or after a canary release.</p>
<p><strong>Combining observability and orchestration makes a closed feedback loop for Chaos Engineering.</strong> If you were to launch a 100 ms network latency test on a Pod, you could observe the latency change using the observability component and check if the Pod service is still available using PromQL or other DSL based on orchestration. If the service was unavailable, you may conclude that the service is unavailable when the latency is &gt;= 100 ms.</p>
<p>But 100 ms is not the threshold of your service; you need to know what is the largest latency your service can handle. By orchestrating the value of the chaos experiment, you&#x27;ll know what is the threshold value you must ensure to meet your service-level objectives. Also, you&#x27;ll find out the service performance under different network conditions and whether they meet your expectations.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_xHUa" id="data-format">Data format<a href="#data-format" class="hash-link" aria-label="Data format的直接链接" title="Data format的直接链接">​</a></h3>
<p>Chaos Mesh uses CRDs to define its chaos objects. If we can convert CRDs to JSON files, we can achieve communication between components.</p>
<p>In terms of data format, chaosd just consumes and registers CRD data in JSON format. If a chaos tool can consume CRD data and register itself, it can run chaos experiments in different scenarios.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_xHUa" id="plugins">Plugins<a href="#plugins" class="hash-link" aria-label="Plugins的直接链接" title="Plugins的直接链接">​</a></h3>
<p>Chaos Mesh has limited support for plugins. You can only <a href="https://chaos-mesh-website-archived.netlify.app/docs/1.2.4/development_guides/develop_a_new_chaos/" target="_blank" rel="noopener noreferrer">add a new Chaos</a> by registering a CRD in Kubernetes API. This brings about two problems:</p>
<ul>
<li>You must develop the plugin using Golang, the same language in which Chaos Mesh is written.</li>
<li>You must merge the extended code into the Chaos Mesh project. Because Chaos Mesh doesn&#x27;t have a security mechanism like Berkeley Packet Filter (BPF), merging plugin code may introduce extra risks.</li>
</ul>
<p>To enable full plugin support, we need to explore a new method to add plugins. As Chaos Mesh essentially carries out chaos experiments based on CRD, a chaos experiment only requires generating, listening to, and deleting CRDs. In this regard, we have several ideas worth trying:</p>
<ul>
<li>Develop a controller or operator to manage CRDs.</li>
<li>Handle CRD events uniformly and operate on CRDs via HTTP callback. This method only uses HTTP APIs, with no requirement on Golang. For an example, see <a href="https://github.com/summerwind/whitebox-controller" target="_blank" rel="noopener noreferrer">Whitebox Controller</a>.</li>
<li>Use WebAssembly (Wasm). When you need to call chaos experiment logic, just call the Wasm program.</li>
<li>Use SQL to query the chaos experiment status. Because Chaos Mesh is based on CRDs, you can use SQL to operate on Kubernetes. Examples include <a href="https://github.com/xuxinkun/kubesql" target="_blank" rel="noopener noreferrer">Presto connector</a> and <a href="https://github.com/aquasecurity/kube-query" target="_blank" rel="noopener noreferrer">osquery extension</a>.</li>
<li>Use SDK-based extensions, such as <a href="https://docs.chaostoolkit.org/reference/api/experiment/" target="_blank" rel="noopener noreferrer">Chaos Toolkit</a>.</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_xHUa" id="integration-with-other-chaos-tools">Integration with other Chaos tools<a href="#integration-with-other-chaos-tools" class="hash-link" aria-label="Integration with other Chaos tools的直接链接" title="Integration with other Chaos tools的直接链接">​</a></h3>
<p>For real-world systems, a single Chaos Engineering tool can hardly exhaust all possible use cases. That&#x27;s why integrating with other chaos tools can make the Chaos Engineering ecosystem more powerful.</p>
<p>There are numerous Chaos Engineering tools on the market. Litmus&#x27;s <a href="https://github.com/litmuschaos/litmus-go/tree/2.14.1/chaoslib/powerfulseal" target="_blank" rel="noopener noreferrer">Kubernetes implementation</a> is based on <a href="https://github.com/powerfulseal/powerfulseal" target="_blank" rel="noopener noreferrer">PowerfulSeal</a>, while its <a href="https://github.com/litmuschaos/litmus-go/tree/2.14.1/chaoslib/pumba" target="_blank" rel="noopener noreferrer">container implementation</a> is based on <a href="https://github.com/alexei-led/pumba" target="_blank" rel="noopener noreferrer">Pumba</a>. <a href="https://github.com/cloud-bulldozer/kraken" target="_blank" rel="noopener noreferrer">Kraken</a> focuses on Kubernetes, <a href="https://github.com/amzn/awsssmchaosrunner" target="_blank" rel="noopener noreferrer">AWSSSMChaosRunner</a> focuses on AWS, and <a href="https://github.com/shopify/toxiproxy" target="_blank" rel="noopener noreferrer">Toxiproxy</a> targets TCP. There are also merging projects based on <a href="https://docs.google.com/presentation/d/1gMlmXqH6ufnb8eNO10WqVjqrPRGAO5-1S1zjcGo1Zr4/edit#slide=id.g58453c664c_2_75" target="_blank" rel="noopener noreferrer">Envoy</a> and Istio.</p>
<p>To manage the various chaos tools, we may need a uniform pattern, such as <a href="https://hub.litmuschaos.io/" target="_blank" rel="noopener noreferrer">Chaos Hub</a>.</p>
<h2 class="anchor anchorWithHideOnScrollNavbar_xHUa" id="voices-from-the-community">Voices from the community<a href="#voices-from-the-community" class="hash-link" aria-label="Voices from the community的直接链接" title="Voices from the community的直接链接">​</a></h2>
<p>Here, we&#x27;d like to share how a leading cyber security company in China as well as a Chaos Mesh user, adapts Chaos Mesh to meet their needs. Their adaptation has three aspects: physical node, container, and application.</p>
<h3 class="anchor anchorWithHideOnScrollNavbar_xHUa" id="physical-node">Physical node<a href="#physical-node" class="hash-link" aria-label="Physical node的直接链接" title="Physical node的直接链接">​</a></h3>
<ul>
<li>Support executing scripts on physical servers. You can configure the script directory in CRDs and run your scripts using <code>chaos-daemon</code>.</li>
<li>Simulate reboot, shutdown, and kernel panic using the customized script.</li>
<li>Shut down the node&#x27;s NIC using the customized script.</li>
<li>Create frequent context switching using sysbench to simulate the &quot;noisy neighbor&quot; effect.</li>
<li>Intercept the container&#x27;s system call using BPF&#x27;s <code>seccomp</code>. This is achieved by passing and filtering PIDs.</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_xHUa" id="container">Container<a href="#container" class="hash-link" aria-label="Container的直接链接" title="Container的直接链接">​</a></h3>
<ul>
<li>Randomly change the number of Deployment replicas to test if the application&#x27;s traffic is abnormal.</li>
<li>Embed based on CRD objects: fill Ingress objects in chaos CRDs to simulate the speed limit of the interface.</li>
<li>Embed based on CRD objects: fill Cilium network policy objects in chaos CRDs to simulate fluctuating network conditions.</li>
</ul>
<h3 class="anchor anchorWithHideOnScrollNavbar_xHUa" id="application">Application<a href="#application" class="hash-link" aria-label="Application的直接链接" title="Application的直接链接">​</a></h3>
<ul>
<li>Support running customized jobs. Currently, Chaos Mesh injects chaos using <code>chaos-daemon</code>, which doesn&#x27;t guarantee fairness and affinity of scheduling. To address this issue, we can use <code>chaos-controller-manager</code> to directly create jobs for different CRDs.</li>
<li>Support running <a href="https://github.com/postmanlabs/newman" target="_blank" rel="noopener noreferrer">Newman</a> in customized jobs to randomly change HTTP parameters. This is to implement chaos experiments on the HTTP interface, which happens when a user performs exceptional behaviors.</li>
</ul>
<h2 class="anchor anchorWithHideOnScrollNavbar_xHUa" id="summary">Summary<a href="#summary" class="hash-link" aria-label="Summary的直接链接" title="Summary的直接链接">​</a></h2>
<p>Traditional fault testing targets specific points in the system that are anticipated to be vulnerable. It is often an assertion: a specific condition produces a specific result.</p>
<p><strong>Chaos Engineering is more powerful in that it helps you discover the &quot;unknown unknowns.&quot;</strong> By exploring in the broader domain, Chaos Engineering deepens your knowledge of the system being tested and unearths new information.</p>
<p>To sum up, these are some of our personal thoughts and practice on Chaos Engineering and Chaos Mesh. Our Hackathon project is not ready for production yet, but we hope to shed some light on CaaS and draft a promising roadmap for Chaos Mesh. If you&#x27;re interested in building Chaos as a Service, <a href="https://slack.cncf.io/" target="_blank" rel="noopener noreferrer">join our Slack</a> (#project-chaos-mesh)!</p></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>标签：</b><ul class="tags_GlUk padding--none margin-left--sm"><li class="tag_ndSj"><a class="tag_Tyas tagRegular_GbUB" href="/zh/blog/tags/chaos-mesh/">Chaos Mesh</a></li><li class="tag_ndSj"><a class="tag_Tyas tagRegular_GbUB" href="/zh/blog/tags/chaos-engineering/">Chaos Engineering</a></li></ul></div></div><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><a href="https://github.com/chaos-mesh/website/edit/master/blog/2021-06-25-chaos-mesh-remake-one-step-closer-toward-chaos-as-a-service.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_h6an" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_WwaV"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="博文分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh/blog/how-to-efficiently-stress-test-pod-memory/"><div class="pagination-nav__sublabel">较新一篇</div><div class="pagination-nav__label">How to efficiently stress test Pod memory</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh/blog/lfx-mentorship-enriching-awschaos/"><div class="pagination-nav__sublabel">较旧一篇</div><div class="pagination-nav__label">From a Newbie in Software Engineering to a Graduated LFX-Mentee</div></a></nav></main><div class="col col--2"><div class="tableOfContents_cNUy thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-is-chaos-as-a-service" class="table-of-contents__link toc-highlight">What is Chaos as a Service?</a></li><li><a href="#developing-chaos-mesh-towards-caas" class="table-of-contents__link toc-highlight">Developing Chaos Mesh towards CaaS</a><ul><li><a href="#refactor-chaos-dashboard" class="table-of-contents__link toc-highlight">Refactor Chaos Dashboard</a></li><li><a href="#refactor-chaosd" class="table-of-contents__link toc-highlight">Refactor chaosd</a></li><li><a href="#improve-observability" class="table-of-contents__link toc-highlight">Improve observability</a></li></ul></li><li><a href="#other-proposals-for-chaos-mesh" class="table-of-contents__link toc-highlight">Other proposals for Chaos Mesh</a><ul><li><a href="#orchestration" class="table-of-contents__link toc-highlight">Orchestration</a></li><li><a href="#data-format" class="table-of-contents__link toc-highlight">Data format</a></li><li><a href="#plugins" class="table-of-contents__link toc-highlight">Plugins</a></li><li><a href="#integration-with-other-chaos-tools" class="table-of-contents__link toc-highlight">Integration with other Chaos tools</a></li></ul></li><li><a href="#voices-from-the-community" class="table-of-contents__link toc-highlight">Voices from the community</a><ul><li><a href="#physical-node" class="table-of-contents__link toc-highlight">Physical node</a></li><li><a href="#container" class="table-of-contents__link toc-highlight">Container</a></li><li><a href="#application" class="table-of-contents__link toc-highlight">Application</a></li></ul></li><li><a href="#summary" class="table-of-contents__link toc-highlight">Summary</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh/docs/quick-start/">快速试用</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/docs/run-a-chaos-experiment/">运行实验</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/docs/developer-guide-overview/">开发指南概览</a></li><li class="footer__item"><a class="footer__link-item" href="/zh/docs/faqs/">常见问题</a></li></ul></div><div class="col footer__col"><div class="footer__title">社区</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh/blog/">博客</a></li><li class="footer__item"><a href="https://community.cncf.io/chaos-mesh-community/" target="_blank" rel="noopener noreferrer" class="footer__link-item">CNCF 社团<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_WtTX"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/chaos-mesh/chaos-mesh" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_WtTX"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://slack.cncf.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack (#project-chaos-mesh)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_WtTX"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/chaos_mesh" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_WtTX"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">致谢</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://storyset.com/technology" target="_blank" rel="noopener noreferrer" class="footer__link-item">Thanks for the technology illustrations by Storyset<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_WtTX"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item">
                <a href="https://www.netlify.com">
                  <img src="https://www.netlify.com/v3/img/components/netlify-color-bg.svg" alt="Deploys by Netlify">
                </a>
              </li><li class="footer__item">
                <img referrerpolicy="no-referrer-when-downgrade" src="https://static.scarf.sh/a.png?x-pxid=3103bfa4-2073-4b9a-bdac-f36f63d979a4">
              </li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
        <p style="font-weight: 500;">Copyright © Chaos Mesh Authors 2024 | Documentation Distributed under CC-BY-4.0</p>
        © 2024 The Linux Foundation. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href="https://www.linuxfoundation.org/trademark-usage/"> Trademark Usage</a> page.
      </div></div></div></footer></div>
</body>
</html>