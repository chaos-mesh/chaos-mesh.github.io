"use strict";(self.webpackChunkchaos_mesh_website=self.webpackChunkchaos_mesh_website||[]).push([["5472"],{45442:function(e,s,h){h.r(s),h.d(s,{frontMatter:()=>a,toc:()=>d,default:()=>t,metadata:()=>n,assets:()=>r,contentTitle:()=>o});var n=JSON.parse('{"id":"upgrade-from-2.1-to-2.2","title":"\u4ECE 2.1 \u5347\u7EA7\u5230 2.2","description":"\u5728 2.2.0 \u7248\u672C\u4E2D\uFF0CHelm Charts \u505A\u4E86\u4E00\u4E9B\u6539\u53D8\u3002\u8FD9\u4E2A\u6587\u6863\u5C06\u5E2E\u52A9\u4F60\u4ECE 2.1.x \u5347\u7EA7\u5230 2.2.0\u3002","source":"@site/i18n/zh/docusaurus-plugin-content-docs/version-2.8.0/upgrade-from-2.1-to-2.2.md","sourceDirName":".","slug":"/upgrade-from-2.1-to-2.2","permalink":"/zh/docs/upgrade-from-2.1-to-2.2","draft":false,"unlisted":false,"editUrl":"https://github.com/chaos-mesh/website/edit/master/i18n/zh/docusaurus-plugin-content-docs/version-2.8.0/upgrade-from-2.1-to-2.2.md","tags":[],"version":"2.8.0","frontMatter":{"title":"\u4ECE 2.1 \u5347\u7EA7\u5230 2.2"},"sidebar":"docs","previous":{"title":"\u5347\u7EA7\u81F3 Chaos Mesh 2.0","permalink":"/zh/docs/upgrade-to-2.0"},"next":{"title":"Chaos Mesh Release Cycle","permalink":"/zh/docs/release-cycle"}}'),l=h(23420),c=h(18407);let a={title:"\u4ECE 2.1 \u5347\u7EA7\u5230 2.2"},o,r={},d=[{value:"\u4F7F\u7528 Helm \u5347\u7EA7",id:"\u4F7F\u7528-helm-\u5347\u7EA7",level:2},{value:"\u7B2C 1 \u6B65\uFF1A\u6DFB\u52A0/\u66F4\u65B0 Chaos Mesh Helm \u4ED3\u5E93",id:"\u7B2C-1-\u6B65\u6DFB\u52A0\u66F4\u65B0-chaos-mesh-helm-\u4ED3\u5E93",level:3},{value:"\u7B2C 2 \u6B65\uFF1A\u8FC1\u79FB <code>values.yaml</code> \u6587\u4EF6",id:"\u7B2C-2-\u6B65\u8FC1\u79FB-valuesyaml-\u6587\u4EF6",level:3},{value:"\u7B2C 3 \u6B65\uFF1A\u66F4\u65B0 CRD",id:"\u7B2C-3-\u6B65\u66F4\u65B0-crd",level:3},{value:"\u7B2C 4 \u6B65\uFF1A\u4F7F\u7528 <code>helm upgrade</code> \u5347\u7EA7 Chaos Mesh",id:"\u7B2C-4-\u6B65\u4F7F\u7528-helm-upgrade-\u5347\u7EA7-chaos-mesh",level:3},{value:"\u8BE2\u95EE\u793E\u533A",id:"\u8BE2\u95EE\u793E\u533A",level:2}];function i(e){let s={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.p,{children:"\u5728 2.2.0 \u7248\u672C\u4E2D\uFF0CHelm Charts \u505A\u4E86\u4E00\u4E9B\u6539\u53D8\u3002\u8FD9\u4E2A\u6587\u6863\u5C06\u5E2E\u52A9\u4F60\u4ECE 2.1.x \u5347\u7EA7\u5230 2.2.0\u3002"}),"\n",(0,l.jsx)(s.h2,{id:"\u4F7F\u7528-helm-\u5347\u7EA7",children:"\u4F7F\u7528 Helm \u5347\u7EA7"}),"\n",(0,l.jsx)(s.h3,{id:"\u7B2C-1-\u6B65\u6DFB\u52A0\u66F4\u65B0-chaos-mesh-helm-\u4ED3\u5E93",children:"\u7B2C 1 \u6B65\uFF1A\u6DFB\u52A0/\u66F4\u65B0 Chaos Mesh Helm \u4ED3\u5E93"}),"\n",(0,l.jsx)(s.p,{children:"\u6DFB\u52A0 Chaos Mesh \u5230 Helm \u4ED3\u5E93\u5E76\u66F4\u65B0\uFF1A"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"helm repo add chaos-mesh https://charts.chaos-mesh.org\nhelm repo update\n"})}),"\n",(0,l.jsxs)(s.h3,{id:"\u7B2C-2-\u6B65\u8FC1\u79FB-valuesyaml-\u6587\u4EF6",children:["\u7B2C 2 \u6B65\uFF1A\u8FC1\u79FB ",(0,l.jsx)(s.code,{children:"values.yaml"})," \u6587\u4EF6"]}),"\n",(0,l.jsxs)(s.p,{children:["\u5982\u679C\u4F60\u5728\u5B89\u88C5 Chaos Mesh \u7684\u65F6\u5019\u4F7F\u7528\u4E86\u4E00\u4E2A\u7279\u5B9A\u7684 ",(0,l.jsx)(s.code,{children:"values.yaml"}),"\uFF0C\u6211\u4EEC\u5EFA\u8BAE\u4F60\u5E94\u7528\u4F60\u7684\u81EA\u5B9A\u4E49\u914D\u7F6E\u5230 Chaos Mesh 2.2.0 \u7684 ",(0,l.jsx)(s.code,{children:"values.yaml"}),"\u3002"]}),"\n",(0,l.jsxs)(s.p,{children:["\u4F60\u53EF\u4EE5\u901A\u8FC7\u8FD9\u4E2A\u547D\u4EE4\u83B7\u53D6\u9ED8\u8BA4\u7684 ",(0,l.jsx)(s.code,{children:"values.yaml"}),"\uFF1A"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"helm show values chaos-mesh/chaos-mesh --version 2.2.0 > values.yaml\n"})}),"\n",(0,l.jsx)(s.p,{children:"\u5982\u679C\u4F60\u4E0D\u719F\u6089\u8FD9\u4E9B\u6539\u53D8\u8FC7\u7684\u914D\u7F6E\uFF0C\u4F60\u53EF\u80FD\u4E0D\u4F1A\u4F9D\u8D56\u8FD9\u4E9B\u7279\u5B9A\u7684\u529F\u80FD\uFF0C\u5FFD\u7565\u4ED6\u4EEC\u901A\u5E38\u662F\u5B89\u5168\u7684\u3002"}),"\n",(0,l.jsx)(s.p,{children:"\u8FD9\u91CC\u662F Helm Chart \u6539\u53D8\u7684\u5217\u8868\uFF1A"}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsxs)(s.li,{children:["\u65B0\u914D\u7F6E\uFF1A",(0,l.jsx)(s.code,{children:"chaosDaemon.mtls.enabled"})," \u8868\u793A\u5728 ",(0,l.jsx)(s.code,{children:"chaos-controller-manager"})," \u548C ",(0,l.jsx)(s.code,{children:"chaos-daemon"})," \u4E4B\u95F4\u4F7F\u7528 mtls\u3002"]}),"\n",(0,l.jsxs)(s.li,{children:["\u65B0\u914D\u7F6E\uFF1A",(0,l.jsx)(s.code,{children:"webhook.caBundlePEM"})," \u8868\u793A\u7528\u4E8E webhook \u670D\u52A1\u7684 CA bundle\u3002"]}),"\n",(0,l.jsxs)(s.li,{children:["\u6539\u53D8\u7684\u503C\uFF1A",(0,l.jsx)(s.code,{children:"dashboard.serviceAccount"})," \u4ECE ",(0,l.jsx)(s.code,{children:"chaos-controller-manager"})," \u6539\u4E3A ",(0,l.jsx)(s.code,{children:"chaos-dashboard"}),"\u3002"]}),"\n",(0,l.jsxs)(s.li,{children:["\u6539\u53D8\u7684\u503C\uFF1A",(0,l.jsx)(s.code,{children:"webhook.FailurePolicy"})," \u4ECE ",(0,l.jsx)(s.code,{children:"Ignore"})," \u6539\u4E3A ",(0,l.jsx)(s.code,{children:"Fail"}),"\u3002"]}),"\n"]}),"\n",(0,l.jsx)(s.admonition,{title:"\u6CE8\u610F",type:"note",children:(0,l.jsxs)(s.p,{children:["\u4F60\u53EF\u4EE5\u5728 ",(0,l.jsx)(s.a,{href:"https://github.com/chaos-mesh/chaos-mesh/blob/v2.2.0/helm/chaos-mesh/README.md",children:"README"})," \u67E5\u770B Helm Chart \u914D\u7F6E\u7684\u8BE6\u7EC6\u63CF\u8FF0\u3002"]})}),"\n",(0,l.jsx)(s.h3,{id:"\u7B2C-3-\u6B65\u66F4\u65B0-crd",children:"\u7B2C 3 \u6B65\uFF1A\u66F4\u65B0 CRD"}),"\n",(0,l.jsxs)(s.p,{children:["\u5982\u679C\u4F60\u7684 ",(0,l.jsx)(s.code,{children:"Kubernetes >= 1.16"}),"\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\u66F4\u65B0 Chaos Mesh CRD\uFF1A"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"kubectl replace -f https://mirrors.chaos-mesh.org/v2.2.0/crd.yaml\n"})}),"\n",(0,l.jsxs)(s.p,{children:["\u5982\u679C\u4F60\u7684 ",(0,l.jsx)(s.code,{children:"Kubernetes <= 1.15"}),"\uFF0C\u4F60\u53EF\u4EE5\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\u66F4\u65B0 Chaos Mesh CRD\uFF1A"]}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"kubectl replace -f https://mirrors.chaos-mesh.org/v2.2.0/crd-v1beta1.yaml\n"})}),"\n",(0,l.jsx)(s.admonition,{title:"\u6CE8\u610F",type:"caution",children:(0,l.jsx)(s.p,{children:"Chaos Mesh 2.2.x \u5C06\u4F1A\u662F\u652F\u6301 Kubernetes < 1.19 \u7684\u6700\u540E\u4E00\u7CFB\u5217\u7248\u672C\u3002"})}),"\n",(0,l.jsxs)(s.h3,{id:"\u7B2C-4-\u6B65\u4F7F\u7528-helm-upgrade-\u5347\u7EA7-chaos-mesh",children:["\u7B2C 4 \u6B65\uFF1A\u4F7F\u7528 ",(0,l.jsx)(s.code,{children:"helm upgrade"})," \u5347\u7EA7 Chaos Mesh"]}),"\n",(0,l.jsx)(s.p,{children:"\u4F60\u53EF\u4EE5\u4F7F\u7528\u4EE5\u4E0B\u547D\u4EE4\u6765\u5347\u7EA7 Chaos Mesh \u5230 2.2.0\uFF1A"}),"\n",(0,l.jsx)(s.pre,{children:(0,l.jsx)(s.code,{className:"language-bash",children:"helm upgrade <release-name> chaos-mesh/chaos-mesh --namespace=<namespace> --version=2.2.0 <--other-required-flags>\n"})}),"\n",(0,l.jsx)(s.h2,{id:"\u8BE2\u95EE\u793E\u533A",children:"\u8BE2\u95EE\u793E\u533A"}),"\n",(0,l.jsxs)(s.p,{children:["\u5982\u679C\u4F60\u5BF9\u5347\u7EA7 Chaos Mesh \u6709\u4EFB\u4F55\u95EE\u9898\uFF0C\u8BF7\u5728 ",(0,l.jsx)(s.a,{href:"https://cloud-native.slack.com/archives/C0193VAV272",children:"Slack Channel"}),"\uFF0CGitHub ",(0,l.jsx)(s.a,{href:"https://github.com/chaos-mesh/chaos-mesh/issues/new?assignees=&labels=&template=question.md",children:"Issues"})," \u548C ",(0,l.jsx)(s.a,{href:"https://github.com/chaos-mesh/chaos-mesh/discussions/new",children:"Discussions"})," \u8054\u7CFB\u6211\u4EEC\u3002"]})]})}function t(e={}){let{wrapper:s}={...(0,c.R)(),...e.components};return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(i,{...e})}):i(e)}},18407:function(e,s,h){h.d(s,{R:()=>a,x:()=>o});var n=h(36672);let l={},c=n.createContext(l);function a(e){let s=n.useContext(c);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),n.createElement(c.Provider,{value:s},e.children)}}}]);